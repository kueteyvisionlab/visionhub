<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vision CRM â€“ PRD Universal Multi-MÃ©tiers v2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300..700;1,9..40,300..700&family=Instrument+Serif:ital@0;1&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            display: ['"Instrument Serif"', 'Georgia', 'serif'],
            body: ['"DM Sans"', 'system-ui', 'sans-serif'],
            mono: ['"JetBrains Mono"', 'monospace'],
          },
          colors: {
            brand: {
              50: '#eef4ff', 100: '#d9e6ff', 200: '#bcd4ff', 300: '#8eb8ff',
              400: '#5891ff', 500: '#3269ff', 600: '#1a46f5', 700: '#1334e1',
              800: '#162cb6', 900: '#182a8f', 950: '#0f1a57',
            },
            surface: {
              0: '#ffffff', 50: '#f8f9fc', 100: '#f1f3f8', 200: '#e4e8f0',
              300: '#cdd3e0', 400: '#9ba5bd', 500: '#6b7894', 600: '#4a5568',
              700: '#374151', 800: '#1f2937', 900: '#111827', 950: '#0a0f1a',
            },
            accent: {
              emerald: '#10b981', amber: '#f59e0b', rose: '#f43f5e',
              violet: '#8b5cf6', cyan: '#06b6d4',
            }
          }
        }
      }
    }
  </script>
  <style>
    * { box-sizing: border-box; }
    body { font-family: 'DM Sans', system-ui, sans-serif; background: #f8f9fc; }
    .sidebar-link { transition: all 0.2s ease; border-left: 3px solid transparent; }
    .sidebar-link:hover, .sidebar-link.active { background: rgba(50,105,255,0.06); border-left-color: #3269ff; color: #1334e1; }
    .card { background: #fff; border: 1px solid #e4e8f0; border-radius: 16px; }
    .badge { display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; border-radius: 999px; font-size: 0.7rem; font-weight: 600; letter-spacing: 0.03em; text-transform: uppercase; }
    .data-table th { background: #f1f3f8; font-size: 0.68rem; font-weight: 600; letter-spacing: 0.06em; text-transform: uppercase; color: #6b7894; padding: 10px 14px; text-align: left; }
    .data-table td { padding: 11px 14px; border-bottom: 1px solid #f1f3f8; font-size: 0.82rem; color: #374151; }
    .data-table tr:last-child td { border-bottom: none; }
    .data-table code { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; background: #f1f3f8; padding: 1px 5px; border-radius: 4px; }
    .timeline-dot { width: 12px; height: 12px; border-radius: 50%; border: 3px solid #3269ff; background: white; position: relative; z-index: 2; flex-shrink: 0; }
    .timeline-line { width: 2px; background: linear-gradient(to bottom, #3269ff, #bcd4ff); position: absolute; top: 12px; bottom: 0; left: 5px; }
    .us-card { border-left: 3px solid; }
    .ac-list li::before { content: 'âœ“'; margin-right: 6px; color: #10b981; font-weight: 700; font-size: 0.75rem; }
    .wf-block { border: 1px dashed #cdd3e0; border-radius: 8px; background: #f8f9fc; padding: 12px 16px; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #cdd3e0; border-radius: 3px; }
    @media (max-width: 1023px) { .sidebar-nav { display: none; } }
    @media print { .sidebar-nav { display: none; } body { background: white; } .card { box-shadow: none; border: 1px solid #ddd; page-break-inside: avoid; } }
  </style>
</head>
<body class="text-surface-700 antialiased">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header class="sticky top-0 z-50 backdrop-blur-xl bg-white/80 border-b border-surface-200">
  <div class="max-w-[1480px] mx-auto px-6 lg:px-10 py-4 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-brand-500 to-brand-700 flex items-center justify-center shadow-lg shadow-brand-500/20">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>
      </div>
      <div>
        <h1 class="text-lg font-bold text-surface-900 tracking-tight leading-none">Vision CRM â€” PRD Universal Multi-MÃ©tiers</h1>
        <p class="text-[11px] text-surface-400 font-medium tracking-wide uppercase mt-0.5">Product Requirements Document v2.0</p>
      </div>
    </div>
    <div class="hidden sm:block text-right">
      <p class="text-xs text-surface-400 leading-relaxed">VisionProdâ€‘Labz Â· FÃ©vrier 2026</p>
      <p class="text-[10px] text-surface-300 mt-0.5">Audience : devs Â· PO Â· designers</p>
    </div>
  </div>
</header>

<div class="max-w-[1480px] mx-auto flex">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<aside class="sidebar-nav w-[260px] flex-shrink-0 sticky top-[73px] h-[calc(100vh-73px)] overflow-y-auto py-6 pl-6 lg:pl-10 pr-3 hidden lg:block">
  <p class="text-[10px] font-bold uppercase tracking-[0.12em] text-surface-400 mb-3 pl-4">Produit</p>
  <nav class="flex flex-col gap-0.5 text-[13px]">
    <a href="#vision" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">01</span>Vision globale</a>
    <a href="#architecture" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">01.5</span>Architecture multi-mÃ©tiers</a>
    <a href="#personas" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">02</span>Personas & rÃ´les</a>
    <a href="#stack" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">03</span>Stack technique</a>
    <a href="#multitenant" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">04</span>Multiâ€‘tenant & sÃ©curitÃ©</a>
    <a href="#modules" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">05</span>Modules & plugins</a>
    <a href="#integrations" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">06</span>IntÃ©grations B2B</a>
    <a href="#userstories" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">07</span>User stories</a>
    <a href="#wireframes" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">08</span>Wireframes</a>
    <a href="#dataapi" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">09</span>Data & API</a>
    <a href="#flux" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">10</span>Flux utilisateur</a>
    <a href="#nfr" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">11</span>Exigences nonâ€‘fonc.</a>
    <a href="#roadmap" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">12</span>Roadmap MVP</a>
    <p class="text-[10px] font-bold uppercase tracking-[0.12em] text-surface-400 mt-4 mb-2 pl-4">OpÃ©rations</p>
    <a href="#infra" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">13</span>Infrastructure</a>
    <a href="#legal" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">14</span>Pages lÃ©gales</a>
    <a href="#kpis" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">15</span>KPIs & mÃ©triques</a>
    <a href="#resilience" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">16</span>Erreurs & rÃ©silience</a>
    <a href="#onboarding" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">17</span>Onboarding flows</a>
    <a href="#analytics" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">18</span>Analytics & tracking</a>
    <a href="#designsystem" class="sidebar-link rounded-r-lg px-4 py-2 font-medium text-surface-600"><span class="text-brand-400 font-mono text-xs mr-1.5">19</span>Design System</a>
  </nav>
</aside>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="flex-1 min-w-0 px-6 lg:px-12 py-8 space-y-12">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     01 â€” VISION GLOBALE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="vision">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">01</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Vision globale</h2>
  </div>

  <div class="card p-6 lg:p-8 mb-6">
    <p class="text-surface-600 leading-relaxed text-[15px] mb-6">
      <strong class="text-surface-900">Vision CRM</strong> est un SaaS multiâ€‘tenant B2B conÃ§u comme un hub CRM unifiÃ© enrichi de modules et d'intelligence artificielle, ciblant les PME franÃ§aises. L'objectif : centraliser donnÃ©es clients, produits, entitÃ©s mÃ©tiers (tenant mÃ©tier), intÃ©grations tierces, IA et facturation dans une plateforme unique, modulaire et extensible.
    </p>
    <div class="grid md:grid-cols-3 gap-4">
      <div class="rounded-xl border border-surface-200 p-5 bg-gradient-to-br from-surface-50 to-white">
        <div class="w-10 h-10 rounded-xl bg-brand-500/10 flex items-center justify-center mb-3">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3269ff" stroke-width="2" stroke-linecap="round"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
        </div>
        <h3 class="font-bold text-surface-900 text-sm mb-1">Site vitrine marketing</h3>
        <p class="text-xs text-surface-500 leading-relaxed">Landing pages, pricing, blog â€” acquisition & conversion des prospects PME via Next.js (stack indÃ©pendante, SSR/SSG, SEO).</p>
      </div>
      <div class="rounded-xl border border-brand-200 p-5 bg-gradient-to-br from-brand-50/50 to-white shadow-sm">
        <div class="w-10 h-10 rounded-xl bg-brand-500/10 flex items-center justify-center mb-3">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3269ff" stroke-width="2" stroke-linecap="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
        </div>
        <h3 class="font-bold text-surface-900 text-sm mb-1">App CRM (Flutter)</h3>
        <p class="text-xs text-surface-500 leading-relaxed">Dashboard pro + dashboard clients. Gestion complÃ¨te des donnÃ©es mÃ©tier multiâ€‘tenant. Mobile iOS/Android + Web.</p>
      </div>
      <div class="rounded-xl border border-surface-200 p-5 bg-gradient-to-br from-surface-50 to-white">
        <div class="w-10 h-10 rounded-xl bg-violet-500/10 flex items-center justify-center mb-3">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>
        </div>
        <h3 class="font-bold text-surface-900 text-sm mb-1">Module IA + Billing</h3>
        <p class="text-xs text-surface-500 leading-relaxed">IA tenantâ€‘aware (analyse, gÃ©nÃ©ration) + facturation usageâ€‘based par tenant via Stripe.</p>
      </div>
    </div>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     01.5 â€” ARCHITECTURE MULTI-MÃ‰TIERS
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="architecture">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-violet-50 flex items-center justify-center"><span class="text-violet-600 font-mono text-sm font-bold">01.5</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Architecture multi-mÃ©tiers</h2>
  </div>

  <div class="card p-6 lg:p-8 mb-6">
    <h3 class="text-xl font-bold text-surface-900 mb-4">Principe Core + Modules</h3>
    <p class="text-surface-600 leading-relaxed text-[15px] mb-6">
      Vision CRM repose sur une architecture <strong class="text-surface-900">Core + Modules mÃ©tiers</strong>. Le noyau universel (Core) fournit les fonctionnalitÃ©s communes Ã  tous les mÃ©tiers : gestion contacts, devis, factures, planning ressources, paiements, WhatsApp Business, rappels automatiques. Les modules mÃ©tiers ajoutent les spÃ©cificitÃ©s sectorielles et s'activent uniquement pour les tenants concernÃ©s.
    </p>

    <div class="bg-gradient-to-br from-violet-50 to-brand-50 rounded-xl p-6 mb-6 border border-violet-200">
      <h4 class="font-bold text-violet-900 mb-3 text-sm uppercase tracking-wide">ğŸ—ï¸ Core Universel (Toujours actif)</h4>
      <div class="grid md:grid-cols-2 gap-3 text-xs">
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">ğŸ“‡ Gestion Contacts</div>
          <p class="text-surface-600">Clients, prospects, fournisseurs â€” CRM universel</p>
        </div>
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">ğŸ’° Devis & Facturation</div>
          <p class="text-surface-600">GÃ©nÃ©ration, envoi, paiements, acomptes</p>
        </div>
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">ğŸ“… Planning Ressources</div>
          <p class="text-surface-600">Calendrier drag-drop pour ressources mÃ©tier</p>
        </div>
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">ğŸ’³ Paiements</div>
          <p class="text-surface-600">Stripe Connect, CB, prÃ©lÃ¨vements, acomptes</p>
        </div>
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">ğŸ’¬ WhatsApp Business</div>
          <p class="text-surface-600">Confirmations, rappels, inbox unifiÃ©e</p>
        </div>
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">ğŸ”” Rappels Auto</div>
          <p class="text-surface-600">IA calcule rappels selon rÃ¨gles mÃ©tier</p>
        </div>
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">â­ Avis Clients</div>
          <p class="text-surface-600">Demandes auto post-service, multi-plateformes</p>
        </div>
        <div class="bg-white/80 rounded-lg p-3">
          <div class="font-semibold text-surface-900 mb-1">ğŸ“± Mode Offline</div>
          <p class="text-surface-600">Cache local 7j, sync auto mobile</p>
        </div>
      </div>
    </div>

    <h3 class="text-xl font-bold text-surface-900 mb-4">Modules mÃ©tiers disponibles</h3>
    <p class="text-surface-600 leading-relaxed text-sm mb-4">
      <strong>Chaque tenant active UNIQUEMENT le(s) module(s) de son mÃ©tier.</strong> Les modules ajoutent des entitÃ©s mÃ©tiers spÃ©cifiques, des intÃ©grations tierces et des workflows adaptÃ©s.
    </p>

    <div class="overflow-x-auto">
      <table class="data-table w-full">
        <thead>
          <tr>
            <th>MÃ©tier</th>
            <th>Module</th>
            <th>EntitÃ© principale</th>
            <th>Features spÃ©cifiques</th>
            <th>IntÃ©grations</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Garage automobile</strong></td>
            <td><code>garage</code></td>
            <td>VÃ©hicule</td>
            <td>Recherche plaque/VIN, catalogue piÃ¨ces, OR</td>
            <td>TechAlliance, TecDoc, HaynesPro</td>
          </tr>
          <tr>
            <td><strong>HÃ´tel</strong></td>
            <td><code>hotel</code></td>
            <td>Chambre</td>
            <td>RÃ©servations, check-in/out, housekeeping</td>
            <td>Booking.com, Expedia, Airbnb</td>
          </tr>
          <tr>
            <td><strong>Restaurant</strong></td>
            <td><code>restaurant</code></td>
            <td>Table/Commande</td>
            <td>Menu digital, caisse, livraison</td>
            <td>UberEats, Deliveroo, TheFork</td>
          </tr>
          <tr>
            <td><strong>Salon esthÃ©tique</strong></td>
            <td><code>beauty</code></td>
            <td>Soin/Produit</td>
            <td>Agenda cabines, e-commerce produits</td>
            <td>Shopify, WooCommerce</td>
          </tr>
          <tr>
            <td><strong>Coiffeur</strong></td>
            <td><code>hair</code></td>
            <td>RDV/Service</td>
            <td>Agenda stylistes, avant/aprÃ¨s photos</td>
            <td>Planity, Treatwell</td>
          </tr>
          <tr>
            <td><strong>Paysagiste</strong></td>
            <td><code>landscaping</code></td>
            <td>Chantier</td>
            <td>Devis chantier, planning Ã©quipes, matÃ©riel</td>
            <td>â€”</td>
          </tr>
          <tr>
            <td><strong>Dentiste</strong></td>
            <td><code>dental</code></td>
            <td>Patient</td>
            <td>Dossier patient, radiologie, traitements</td>
            <td>Doctolib, DMD</td>
          </tr>
          <tr>
            <td><strong>Avocat</strong></td>
            <td><code>legal</code></td>
            <td>Dossier/Client</td>
            <td>Facturation horaire, deadlines, plaidoiries</td>
            <td>â€”</td>
          </tr>
          <tr>
            <td><strong>MÃ©decin gÃ©nÃ©raliste</strong></td>
            <td><code>medical</code></td>
            <td>Patient</td>
            <td>TÃ©lÃ©consultation, ordonnances, dossier mÃ©dical</td>
            <td>Doctolib, Cegedim</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-6 bg-brand-50 rounded-xl p-6 border border-brand-200">
      <h4 class="font-bold text-brand-900 mb-3 flex items-center gap-2">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
        Exemple concret : Module Garage
      </h4>
      <p class="text-surface-700 text-sm leading-relaxed mb-3">
        Un tenant de type "Garage automobile" active le module <code class="font-mono bg-white px-2 py-0.5 rounded text-xs">garage</code>. Ce module ajoute :
      </p>
      <ul class="text-surface-700 text-sm space-y-1.5">
        <li class="flex items-start gap-2"><span class="text-brand-500 font-bold">â†’</span>Table <code class="font-mono bg-white px-1.5 py-0.5 rounded text-xs">Entity</code> avec type=<code class="text-xs">vehicle</code></li>
        <li class="flex items-start gap-2"><span class="text-brand-500 font-bold">â†’</span>Recherche plaque d'immatriculation via API SIV</li>
        <li class="flex items-start gap-2"><span class="text-brand-500 font-bold">â†’</span>Catalogue piÃ¨ces via TecDoc, HaynesPro</li>
        <li class="flex items-start gap-2"><span class="text-brand-500 font-bold">â†’</span>Ordres de rÃ©paration (type <code class="text-xs">repair</code> dans <code class="font-mono bg-white px-1.5 py-0.5 rounded text-xs">ServiceOrder</code>)</li>
        <li class="flex items-start gap-2"><span class="text-brand-500 font-bold">â†’</span>Gestion stock piÃ¨ces (<code class="font-mono bg-white px-1.5 py-0.5 rounded text-xs">InventoryItem</code>)</li>
      </ul>
      <p class="text-surface-600 text-xs mt-3 italic">
        Le module garage est dÃ©sormais un EXEMPLE d'implÃ©mentation mÃ©tier, pas le cÅ“ur de la plateforme.
      </p>
    </div>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     02 â€” PERSONAS & RÃ”LES
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="personas">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">02</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Personas & rÃ´les</h2>
  </div>

  <div class="grid md:grid-cols-2 gap-6">

    <!-- Persona 1 â€” Pro Owner -->
    <div class="card p-6 border-t-4 border-t-brand-500">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-12 h-12 rounded-full bg-brand-100 flex items-center justify-center text-xl">ğŸ‘¨â€ğŸ”§</div>
        <div>
          <h3 class="font-bold text-surface-900 text-sm">Karim â€” GÃ©rant de tenant mÃ©tier</h3>
          <p class="text-xs text-surface-400">RÃ´le systÃ¨me : <code class="font-mono bg-surface-100 px-1.5 py-0.5 rounded text-xs">admin</code> / <code class="font-mono bg-surface-100 px-1.5 py-0.5 rounded text-xs">pro</code></p>
        </div>
      </div>
      <div class="space-y-3 text-xs">
        <div>
          <p class="font-semibold text-surface-800 mb-1">Profil</p>
          <p class="text-surface-500 leading-relaxed">GÃ©rant d'un tenant mÃ©tier indÃ©pendant Ã  Metz, 4 ressources mÃ©tiers, 800+ clients. MaÃ®trise les outils numÃ©riques de base mais pas le dÃ©veloppement. Cherche Ã  moderniser sans complexitÃ©.</p>
        </div>
        <div>
          <p class="font-semibold text-surface-800 mb-1">Objectifs</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Centraliser fiches clients, entitÃ©s mÃ©tiers, historiques et devis en un seul outil.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Identifier items inventaire en 2 clics via la identifiant mÃ©tier.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Suivre la rentabilitÃ© de son tenant mÃ©tier (CA, marges, crÃ©ances).</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Activer des modules Ã  la demande sans intervention technique.</li>
          </ul>
        </div>
        <div>
          <p class="font-semibold text-accent-rose mb-1">Douleurs actuelles</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Excel + carnet papier pour les devis et les relances.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Recherche piÃ¨ces = 3 sites ouverts en parallÃ¨le (TecDoc, HaynesPro, fournisseur).</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Aucune visibilitÃ© temps rÃ©el sur les interventions en cours.</li>
          </ul>
        </div>
        <div class="bg-brand-50/50 rounded-lg p-3">
          <p class="font-semibold text-brand-700 mb-1">Ce que Vision CRM lui apporte</p>
          <p class="text-surface-600 leading-relaxed">Un hub unique oÃ¹ il gÃ¨re clients, entitÃ©s mÃ©tiers, piÃ¨ces, devis et facturation. recherche entitÃ© mÃ©tier instantanÃ©e, modules activables en un clic, visibilitÃ© complÃ¨te sur l'activitÃ©.</p>
        </div>
      </div>
    </div>

    <!-- Persona 2 â€” Collaborateur -->
    <div class="card p-6 border-t-4 border-t-accent-amber">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-12 h-12 rounded-full bg-amber-100 flex items-center justify-center text-xl">ğŸ”§</div>
        <div>
          <h3 class="font-bold text-surface-900 text-sm">Fatou â€” MÃ©canicienne</h3>
          <p class="text-xs text-surface-400">RÃ´le systÃ¨me : <code class="font-mono bg-surface-100 px-1.5 py-0.5 rounded text-xs">pro</code> (droits limitÃ©s)</p>
        </div>
      </div>
      <div class="space-y-3 text-xs">
        <div>
          <p class="font-semibold text-surface-800 mb-1">Profil</p>
          <p class="text-surface-500 leading-relaxed">MÃ©canicienne expÃ©rimentÃ©e chez Karim. Utilise un smartphone au quotidien, peu de patience pour les logiciels complexes. Veut des outils rapides utilisables entre deux interventions.</p>
        </div>
        <div>
          <p class="font-semibold text-surface-800 mb-1">Objectifs</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span>Consulter la fiche entitÃ© mÃ©tier et l'historique d'un client en 1 tap.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span>Chercher les piÃ¨ces compatibles via plaque ou ID mÃ©tier depuis le mobile.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span>Mettre Ã  jour le statut de l'intervention (en cours, terminÃ©e, bloquÃ©e).</li>
          </ul>
        </div>
        <div>
          <p class="font-semibold text-accent-rose mb-1">Douleurs actuelles</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Demande les infos au gÃ©rant Ã  chaque fois â†’ perte de temps.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Doit quitter le poste pour vÃ©rifier les rÃ©fÃ©rences piÃ¨ces sur un PC.</li>
          </ul>
        </div>
        <div class="bg-amber-50/50 rounded-lg p-3">
          <p class="font-semibold text-amber-700 mb-1">Ce que Vision CRM lui apporte</p>
          <p class="text-surface-600 leading-relaxed">Un accÃ¨s mobile rapide Ã  toutes les infos entitÃ© mÃ©tier et client, recherche piÃ¨ces sur place, mise Ã  jour de l'avancement directement depuis son poste.</p>
        </div>
      </div>
    </div>

    <!-- Persona 3 â€” Client final -->
    <div class="card p-6 border-t-4 border-t-accent-emerald">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-12 h-12 rounded-full bg-emerald-100 flex items-center justify-center text-xl">ğŸš—</div>
        <div>
          <h3 class="font-bold text-surface-900 text-sm">Sophie â€” Cliente particuliÃ¨re</h3>
          <p class="text-xs text-surface-400">RÃ´le systÃ¨me : <code class="font-mono bg-surface-100 px-1.5 py-0.5 rounded text-xs">client</code></p>
        </div>
      </div>
      <div class="space-y-3 text-xs">
        <div>
          <p class="font-semibold text-surface-800 mb-1">Profil</p>
          <p class="text-surface-500 leading-relaxed">PropriÃ©taire d'une Renault Clio, 34 ans, active. N'y connaÃ®t rien en mÃ©canique. Veut de la transparence, des rappels et un suivi simple.</p>
        </div>
        <div>
          <p class="font-semibold text-surface-800 mb-1">Objectifs</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span>Voir l'historique complet de son entitÃ© mÃ©tier (interventions, piÃ¨ces, coÃ»ts).</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span>Recevoir des rappels d'entretien (vidange, contrÃ´le technique).</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span>Consulter et valider un devis en ligne.</li>
          </ul>
        </div>
        <div>
          <p class="font-semibold text-accent-rose mb-1">Douleurs actuelles</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Ne sait jamais oÃ¹ en est la prestation â†’ appelle 3 fois.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Devis sur papier, pas de comparatif, aucune traÃ§abilitÃ©.</li>
          </ul>
        </div>
        <div class="bg-emerald-50/50 rounded-lg p-3">
          <p class="font-semibold text-emerald-700 mb-1">Ce que Vision CRM lui apporte</p>
          <p class="text-surface-600 leading-relaxed">Un espace client selfâ€‘service avec suivi entitÃ© mÃ©tier, historique, devis en ligne, rappels automatiques et notifications push.</p>
        </div>
      </div>
    </div>

    <!-- Persona 4 â€” Admin Plateforme -->
    <div class="card p-6 border-t-4 border-t-accent-cyan">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-12 h-12 rounded-full bg-cyan-100 flex items-center justify-center text-xl">ğŸ›¡ï¸</div>
        <div>
          <h3 class="font-bold text-surface-900 text-sm">Toi â€” Admin plateforme</h3>
          <p class="text-xs text-surface-400">RÃ´le systÃ¨me : <code class="font-mono bg-surface-100 px-1.5 py-0.5 rounded text-xs">super_admin</code></p>
        </div>
      </div>
      <div class="space-y-3 text-xs">
        <div>
          <p class="font-semibold text-surface-800 mb-1">Profil</p>
          <p class="text-surface-500 leading-relaxed">Fondateur / opÃ©rateur de la plateforme Vision CRM. GÃ¨re le produit, le billing global, le monitoring et le support multiâ€‘tenant. Vision technique et business complÃ¨te.</p>
        </div>
        <div>
          <p class="font-semibold text-surface-800 mb-1">Objectifs</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-cyan flex-shrink-0"></span>Monitorer l'usage, la santÃ© et la performance de tous les tenants en temps rÃ©el.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-cyan flex-shrink-0"></span>GÃ©rer la facturation globale, les plans, les crÃ©dits IA et le revenue.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-cyan flex-shrink-0"></span>Intervenir en support sur n'importe quel tenant (impersonation sÃ©curisÃ©e).</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-cyan flex-shrink-0"></span>Activer/dÃ©sactiver des modules globalement, gÃ©rer les feature flags et les releases.</li>
          </ul>
        </div>
        <div>
          <p class="font-semibold text-accent-rose mb-1">Douleurs actuelles</p>
          <ul class="text-surface-500 leading-relaxed space-y-1">
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Aucun dashboard de monitoring centralisÃ© â€” tout est manuel (logs, Stripe dashboard, DB directe).</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Pas de visibilitÃ© sur l'usage rÃ©el par tenant, les quotas sont suivis Ã  la main.</li>
            <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-rose flex-shrink-0"></span>Support client = accÃ¨s direct Ã  la base de donnÃ©es, risque d'erreur humaine.</li>
          </ul>
        </div>
        <div class="bg-cyan-50/50 rounded-lg p-3">
          <p class="font-semibold text-cyan-700 mb-1">Ce que Vision CRM lui apporte</p>
          <p class="text-surface-600 leading-relaxed">Un backâ€‘office super_admin avec vue multiâ€‘tenant, monitoring temps rÃ©el, gestion billing/plans, impersonation sÃ©curisÃ©e, feature flags et alertes automatiques.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Matrice rÃ´les/permissions -->
  <div class="card overflow-hidden mt-6">
    <div class="px-6 py-4 border-b border-surface-200">
      <h3 class="text-sm font-bold text-surface-900">Matrice des permissions RBAC</h3>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Action</th><th>super_admin</th><th>admin</th><th>pro</th><th>client</th></tr></thead>
      <tbody>
        <tr><td>Voir tous les tenants / monitoring global</td><td class="text-center">âœ…</td><td class="text-center">â€”</td><td class="text-center">â€”</td><td class="text-center">â€”</td></tr>
        <tr><td>Impersonation (accÃ©der Ã  un tenant)</td><td class="text-center">âœ…</td><td class="text-center">â€”</td><td class="text-center">â€”</td><td class="text-center">â€”</td></tr>
        <tr><td>GÃ©rer les plans / feature flags globaux</td><td class="text-center">âœ…</td><td class="text-center">â€”</td><td class="text-center">â€”</td><td class="text-center">â€”</td></tr>
        <tr><td>CrÃ©er / supprimer un tenant</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td><td class="text-center">â€”</td></tr>
        <tr><td>Inviter / gÃ©rer les collaborateurs</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td><td class="text-center">â€”</td></tr>
        <tr><td>Activer / dÃ©sactiver des modules</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td><td class="text-center">â€”</td></tr>
        <tr><td>Configurer les clÃ©s API</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td><td class="text-center">â€”</td></tr>
        <tr><td>Voir facturation & quotas</td><td class="text-center">âœ… (tous)</td><td class="text-center">âœ…</td><td class="text-center">ğŸ‘ï¸ lecture</td><td class="text-center">â€”</td></tr>
        <tr><td>CrÃ©er / modifier clients</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td></tr>
        <tr><td>recherche entitÃ© mÃ©tier / ID mÃ©tier</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td></tr>
        <tr><td>CrÃ©er / envoyer devis</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td></tr>
        <tr><td>Utiliser l'IA (gÃ©nÃ©ration, analyse)</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">âœ…</td><td class="text-center">â€”</td></tr>
        <tr><td>Voir ses propres entitÃ©s mÃ©tiers / devis</td><td class="text-center">â€”</td><td class="text-center">â€”</td><td class="text-center">â€”</td><td class="text-center">âœ…</td></tr>
        <tr><td>Valider / refuser un devis</td><td class="text-center">â€”</td><td class="text-center">â€”</td><td class="text-center">â€”</td><td class="text-center">âœ…</td></tr>
        <tr><td>Consulter historique interventions</td><td class="text-center">âœ… (tous)</td><td class="text-center">âœ… (tous)</td><td class="text-center">âœ… (tous)</td><td class="text-center">âœ… (les siens)</td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     03 â€” STACK TECHNIQUE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="stack">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">03</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Stack technique</h2>
  </div>
  <div class="card overflow-hidden">
    <table class="data-table w-full">
      <thead><tr><th class="w-44">Couche</th><th>Technologie</th><th>DÃ©tails</th></tr></thead>
      <tbody>
        <tr><td><span class="badge bg-blue-50 text-blue-700">Frontend â€” App</span></td><td class="font-semibold text-surface-900">Flutter</td><td>Mobile (iOS & Android) + Web. Un seul codebase pour le CRM pro et client.</td></tr>
        <tr><td><span class="badge bg-cyan-50 text-cyan-700">Frontend â€” Vitrine</span></td><td class="font-semibold text-surface-900">Next.js</td><td>Site marketing sÃ©parÃ©. SSR/SSG, SEO optimisÃ©, stack indÃ©pendante.</td></tr>
        <tr><td><span class="badge bg-emerald-50 text-emerald-700">Backend / API</span></td><td class="font-semibold text-surface-900">Node.js / Supabase</td><td>API modulaire REST + Realtime. Supabase Edge Functions ou serveur Node custom. Architecture plugin.</td></tr>
        <tr><td><span class="badge bg-amber-50 text-amber-700">Base de donnÃ©es</span></td><td class="font-semibold text-surface-900">PostgreSQL</td><td>Multiâ€‘tenant avec <code>tenant_id</code> sur chaque table. RLS via Supabase.</td></tr>
        <tr><td><span class="badge bg-violet-50 text-violet-700">Authentification</span></td><td class="font-semibold text-surface-900">Supabase Auth / Clerk / Logto</td><td>Multiâ€‘tenant natif, MFA optionnel, OAuth (Google, Apple), magic links.</td></tr>
        <tr><td><span class="badge bg-rose-50 text-rose-700">HÃ©bergement</span></td><td class="font-semibold text-surface-900">Scaleway / OVH / Hetzner</td><td>Cloud EU (RGPD). Alternatives : Render, Railway, Supabase Cloud.</td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     04 â€” MULTIâ€‘TENANT & SÃ‰CURITÃ‰
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="multitenant">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">04</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Multiâ€‘tenant & sÃ©curitÃ©</h2>
  </div>
  <div class="grid lg:grid-cols-2 gap-6">
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#3269ff" stroke-width="2" stroke-linecap="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5v14c0 1.66 4.03 3 9 3s9-1.34 9-3V5"/><path d="M3 12c0 1.66 4.03 3 9 3s9-1.34 9-3"/></svg>
        ModÃ¨le de donnÃ©es
      </h3>
      <div class="flex flex-wrap gap-2">
        <span class="font-mono text-xs bg-surface-900 text-white px-3 py-1.5 rounded-lg">Tenant</span>
        <span class="font-mono text-xs bg-surface-800 text-white px-3 py-1.5 rounded-lg">User</span>
        <span class="font-mono text-xs bg-surface-700 text-white px-3 py-1.5 rounded-lg">Client</span>
        <span class="font-mono text-xs bg-brand-600 text-white px-3 py-1.5 rounded-lg">Product</span>
        <span class="font-mono text-xs bg-brand-700 text-white px-3 py-1.5 rounded-lg">Vehicle</span>
        <span class="font-mono text-xs bg-brand-800 text-white px-3 py-1.5 rounded-lg">Order</span>
        <span class="font-mono text-xs bg-violet-600 text-white px-3 py-1.5 rounded-lg">UsageLog</span>
        <span class="font-mono text-xs bg-violet-700 text-white px-3 py-1.5 rounded-lg">Module</span>
        <span class="font-mono text-xs bg-violet-800 text-white px-3 py-1.5 rounded-lg">TenantModule</span>
      </div>
      <p class="text-xs text-surface-400 mt-4 leading-relaxed">Chaque table porte <code>tenant_id</code> â€” isolation stricte via RLS PostgreSQL. Voir section 09 pour le schÃ©ma dÃ©taillÃ©.</p>
    </div>
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        SÃ©curitÃ© & conformitÃ©
      </h3>
      <ul class="space-y-3 text-sm text-surface-600">
        <li class="flex items-start gap-2.5"><span class="mt-1 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><span><strong class="text-surface-800">HTTPS partout</strong> â€” chiffrement en transit + at rest, backups automatiques quotidiens.</span></li>
        <li class="flex items-start gap-2.5"><span class="mt-1 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><span><strong class="text-surface-800">RBAC strict</strong> â€” 4 rÃ´les : <code>super_admin</code> (plateforme), <code>admin</code> (tenant owner), <code>pro</code>, <code>client</code>. Isolation par tenant_id.</span></li>
        <li class="flex items-start gap-2.5"><span class="mt-1 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><span><strong class="text-surface-800">Logs d'audit</strong> â€” traÃ§abilitÃ© complÃ¨te (qui, quoi, quand, quel tenant).</span></li>
        <li class="flex items-start gap-2.5"><span class="mt-1 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><span><strong class="text-surface-800">RGPD + CGU</strong> â€” consentements, autorisations intÃ©grations tierces, droit Ã  l'oubli.</span></li>
      </ul>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     05 â€” MODULES & PLUGINS
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="modules">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">05</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Modules & plugins</h2>
  </div>

  <div class="card p-6 lg:p-8 mb-6">
    <h3 class="text-sm font-bold text-surface-900 mb-3">Architecture modulaire</h3>
    <p class="text-sm text-surface-600 leading-relaxed mb-5">Core minimal + modules (plugins) activables par tenant. Chaque module = dossier backend (API) + dossier Flutter (UI) + entrÃ©es dans <code>Module</code> et <code>TenantModule</code>.</p>
    <div class="flex items-center gap-3 text-xs font-mono text-surface-500 bg-surface-50 rounded-xl p-4 overflow-x-auto">
      <span class="bg-brand-600 text-white px-3 py-1.5 rounded-lg font-semibold whitespace-nowrap">Core</span>
      <span class="text-surface-300">â†’</span>
      <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg whitespace-nowrap">tenant mÃ©tier</span>
      <span class="text-surface-300">â†’</span>
      <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg whitespace-nowrap">billing</span>
      <span class="text-surface-300">â†’</span>
      <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg whitespace-nowrap">ai</span>
      <span class="text-surface-300">â†’</span>
      <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg whitespace-nowrap">inventory</span>
      <span class="text-surface-300">â†’</span>
      <span class="bg-surface-100 text-surface-400 px-3 py-1.5 rounded-lg whitespace-nowrap border border-dashed border-surface-300">â€¦extensible</span>
    </div>
  </div>

  <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
    <div class="card p-5 border-t-4 border-t-brand-500">
      <div class="flex items-center justify-between mb-3"><h4 class="font-bold text-surface-900 text-sm">tenant mÃ©tier</h4><span class="badge bg-brand-50 text-brand-700">MVP</span></div>
      <p class="text-xs text-surface-500 leading-relaxed">recherche entitÃ© mÃ©tier/ID mÃ©tier via TechAlliance, TecDoc, HaynesPro. Catalogue piÃ¨ces, devis, historique entitÃ© mÃ©tier.</p>
    </div>
    <div class="card p-5 border-t-4 border-t-accent-amber">
      <div class="flex items-center justify-between mb-3"><h4 class="font-bold text-surface-900 text-sm">billing</h4><span class="badge bg-amber-50 text-amber-700">MVP</span></div>
      <p class="text-xs text-surface-500 leading-relaxed">Quotas, crÃ©dits IA, facturation par tenant. Forfait + usage mesurÃ©. Stripe Connect.</p>
    </div>
    <div class="card p-5 border-t-4 border-t-accent-violet">
      <div class="flex items-center justify-between mb-3"><h4 class="font-bold text-surface-900 text-sm">ai</h4><span class="badge bg-violet-50 text-violet-700">MVP</span></div>
      <p class="text-xs text-surface-500 leading-relaxed">IA tenantâ€‘aware : analyse de donnÃ©es, gÃ©nÃ©ration de textes, suggestions intelligentes.</p>
    </div>
    <div class="card p-5 border-t-4 border-t-surface-300">
      <div class="flex items-center justify-between mb-3"><h4 class="font-bold text-surface-900 text-sm">inventory Â· leads</h4><span class="badge bg-surface-100 text-surface-500">Postâ€‘MVP</span></div>
      <p class="text-xs text-surface-500 leading-relaxed">Gestion de stock avancÃ©e, pipeline de leads, scoring, nurturing automatisÃ©.</p>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     06 â€” INTÃ‰GRATIONS B2B
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="integrations">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">06</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">IntÃ©grations B2B</h2>
  </div>
  <p class="text-sm text-surface-600 mb-5 leading-relaxed">Chaque intÃ©gration = module B2B activable. ClÃ©s API chiffrÃ©es dans <code>TenantModule.config_json</code>, endpoints sous <code>/integrations/&lt;module&gt;/*</code>, usage loguÃ© pour billing.</p>
  <div class="card overflow-hidden">
    <table class="data-table w-full">
      <thead><tr><th class="w-40">CatÃ©gorie</th><th>Fournisseurs</th><th class="w-36">Statut</th></tr></thead>
      <tbody>
        <tr><td><span class="badge bg-blue-50 text-blue-700">ğŸ”§ tenant mÃ©tier / Auto</span></td><td><code>TechAlliance</code> Â· <code>TecDoc</code> Â· <code>HaynesPro</code></td><td><span class="badge bg-brand-50 text-brand-700">MVP</span></td></tr>
        <tr><td><span class="badge bg-emerald-50 text-emerald-700">ğŸ›’ Eâ€‘commerce</span></td><td><code>Shopify</code> Â· <code>WooCommerce</code> Â· <code>Prestashop</code></td><td><span class="badge bg-surface-100 text-surface-500">Postâ€‘MVP</span></td></tr>
        <tr><td><span class="badge bg-amber-50 text-amber-700">ğŸ“Š ComptabilitÃ©</span></td><td><code>QuickBooks</code> Â· <code>Xero</code> Â· <code>Sage</code></td><td><span class="badge bg-surface-100 text-surface-500">Postâ€‘MVP</span></td></tr>
        <tr><td><span class="badge bg-violet-50 text-violet-700">ğŸ“¦ Livraisons</span></td><td><code>Chronopost</code> Â· <code>Colissimo</code> Â· <code>Sendcloud</code></td><td><span class="badge bg-surface-100 text-surface-500">Postâ€‘MVP</span></td></tr>
        <tr><td><span class="badge bg-rose-50 text-rose-700">ğŸ¤ CRM tiers</span></td><td><code>HubSpot</code> Â· <code>Pipedrive</code></td><td><span class="badge bg-surface-100 text-surface-500">Postâ€‘MVP</span></td></tr>
        <tr><td><span class="badge bg-cyan-50 text-cyan-700">ğŸ’³ Paiements</span></td><td><code>Stripe</code> Â· <code>PayPal</code> Â· <code>Mollie</code></td><td><span class="badge bg-brand-50 text-brand-700">MVP (Stripe)</span></td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     07 â€” USER STORIES PAR MODULE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="userstories">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">07</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">User stories par module</h2>
  </div>

  <!-- â”€â”€â”€â”€ MODULE tenant mÃ©tier â”€â”€â”€â”€ -->
  <div class="card p-6 mb-6">
    <h3 class="text-base font-bold text-surface-900 mb-1 flex items-center gap-2">
      <span class="w-3 h-3 rounded bg-brand-500"></span> Module : tenant mÃ©tier
    </h3>
    <p class="text-xs text-surface-400 mb-5">Recherche entitÃ© mÃ©tier, catalogue piÃ¨ces, devis</p>

    <div class="space-y-4">
      <!-- US-G01 -->
      <div class="us-card border-l-brand-400 bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘G01 Â· admin / pro</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro, je veux chercher un entitÃ© mÃ©tier par identifiant mÃ©tier afin d'identifier le modÃ¨le exact et ses caractÃ©ristiques techniques.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>La saisie d'une plaque franÃ§aise valide (AAâ€‘123â€‘BB) retourne marque, modÃ¨le, motorisation, annÃ©e en &lt; 2 s.</li>
          <li>Si la plaque est invalide ou inconnue, un message d'erreur explicite s'affiche (pas de crash).</li>
          <li>L'appel TechAlliance/TecDoc est loguÃ© dans <code>UsageLog</code> avec le coÃ»t associÃ©.</li>
          <li>Seuls les utilisateurs dont le tenant a le module <code>tenant mÃ©tier</code> actif peuvent accÃ©der Ã  l'Ã©cran.</li>
          <li>Le rÃ©sultat est cacheable pendant 24 h pour Ã©viter les appels API redondants.</li>
        </ul>
      </div>

      <!-- US-G02 -->
      <div class="us-card border-l-brand-400 bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘G02 Â· admin / pro</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro, je veux chercher un entitÃ© mÃ©tier par numÃ©ro ID mÃ©tier afin de gÃ©rer les cas sans plaque visible ou les entitÃ©s mÃ©tiers importÃ©s.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Un ID mÃ©tier de 17 caractÃ¨res valide retourne les mÃªmes donnÃ©es qu'une recherche par plaque.</li>
          <li>La validation du format ID mÃ©tier est faite cÃ´tÃ© client avant l'appel API.</li>
          <li>Si le ID mÃ©tier n'est pas trouvÃ©, proposer une saisie manuelle du entitÃ© mÃ©tier.</li>
        </ul>
      </div>

      <!-- US-G03 -->
      <div class="us-card border-l-brand-400 bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘G03 Â· admin / pro</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro, je veux consulter le catalogue de piÃ¨ces compatibles pour un entitÃ© mÃ©tier identifiÃ© afin de construire un devis rapidement.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>AprÃ¨s identification du entitÃ© mÃ©tier, l'arbre des catÃ©gories de piÃ¨ces s'affiche en &lt; 1 s.</li>
          <li>Chaque item affiche : rÃ©fÃ©rence, fabricant, prix catalogue, disponibilitÃ© fournisseur.</li>
          <li>Le pro peut ajouter une item au panier / devis en un clic.</li>
          <li>Les donnÃ©es proviennent de TecDoc / HaynesPro en fonction de la config du tenant.</li>
        </ul>
      </div>

      <!-- US-G04 -->
      <div class="us-card border-l-brand-400 bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘G04 Â· admin / pro</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro, je veux crÃ©er un devis pour un client avec piÃ¨ces + main d'Å“uvre afin de lui envoyer un document chiffrÃ© professionnel.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Le devis inclut : lignes piÃ¨ces (ref, qtÃ©, PU, total), lignes MO (temps, taux horaire), TVA, total TTC.</li>
          <li>Le devis est associÃ© au client, au entitÃ© mÃ©tier et au tenant.</li>
          <li>Export PDF avec enâ€‘tÃªte du tenant mÃ©tier (nom, SIRET, adresse, logo).</li>
          <li>Le devis peut Ãªtre envoyÃ© par email ou lien partageable au client.</li>
          <li>Statuts : brouillon â†’ envoyÃ© â†’ acceptÃ© / refusÃ©.</li>
        </ul>
      </div>

      <!-- US-G05 -->
      <div class="us-card border-l-brand-400 bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘G05 Â· admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant qu'admin, je veux voir l'historique complet d'un entitÃ© mÃ©tier (interventions, piÃ¨ces, devis) afin d'avoir une traÃ§abilitÃ© complÃ¨te.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>L'historique est triÃ© par date dÃ©croissante avec filtre par type (devis, intervention, item).</li>
          <li>Chaque entrÃ©e est cliquable vers le dÃ©tail (devis, fiche intervention).</li>
          <li>Les donnÃ©es d'un tenant ne sont jamais visibles par un autre tenant (RLS).</li>
        </ul>
      </div>

      <!-- US-G06 -->
      <div class="us-card border-l-accent-emerald bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘G06 Â· client</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que client, je veux consulter l'historique d'entretien de mon entitÃ© mÃ©tier afin de savoir ce qui a Ã©tÃ© fait et quand.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Le client ne voit que ses propres entitÃ©s mÃ©tiers et interventions.</li>
          <li>Affichage simplifiÃ© : date, type d'intervention, coÃ»t total, statut.</li>
          <li>Pas d'accÃ¨s aux marges, prix d'achat piÃ¨ces ou donnÃ©es internes du tenant mÃ©tier.</li>
        </ul>
      </div>

      <!-- US-G07 -->
      <div class="us-card border-l-accent-emerald bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘G07 Â· client</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que client, je veux accepter ou refuser un devis en ligne afin de gagner du temps et Ã©viter les allersâ€‘retours.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Le client accÃ¨de au devis via un lien sÃ©curisÃ© (token unique, expiration 30 j).</li>
          <li>Actions : Â« Accepter Â» (signature Ã©lectronique simple) ou Â« Refuser Â» (motif optionnel).</li>
          <li>Le pro reÃ§oit une notification en temps rÃ©el (push + inâ€‘app).</li>
          <li>Le statut du devis est mis Ã  jour instantanÃ©ment cÃ´tÃ© pro.</li>
        </ul>
      </div>
    </div>
  </div>


  <!-- â”€â”€â”€â”€ FEATURES MVP UNIVERSELLES (CORE) â”€â”€â”€â”€ -->
  <div class="card p-6 mb-6 border-t-4 border-t-violet-500">
    <h3 class="text-base font-bold text-surface-900 mb-1 flex items-center gap-2">
      <span class="w-3 h-3 rounded bg-violet-500"></span> Features MVP Universelles (Core Platform)
    </h3>
    <p class="text-xs text-surface-400 mb-5">FonctionnalitÃ©s critiques mÃ©tier-agnostiques pour tous les tenants</p>

    <div class="space-y-4">
      <!-- MVP-01 : Acomptes/Deposits -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘01 Â· Feature : Acomptes / Deposits (Universel)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que tenant (garage/hÃ´tel/esthÃ©tique/avocat), je veux demander un acompte automatique (ex: 50% si devis > Xâ‚¬) pour sÃ©curiser les rÃ©servations/commandes.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Configuration par tenant : % acompte, montant minimum dÃ©clencheur, conditions mÃ©tier</li>
          <li>Calcul automatique lors de la crÃ©ation du devis/commande</li>
          <li>Statut <code>Order.deposit</code> : null, requested, paid, refunded</li>
          <li>Lien de paiement sÃ©curisÃ© Stripe envoyÃ© au client (email/WhatsApp)</li>
          <li>Webhook Stripe met Ã  jour le statut en temps rÃ©el</li>
          <li>Historique des acomptes dans <code>PaymentTransaction</code></li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">ğŸ“‹ Exemples multi-mÃ©tiers :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage</strong> : 50% si devis rÃ©paration > 200â‚¬</li>
            <li><strong>HÃ´tel</strong> : 30% Ã  la rÃ©servation de chambre</li>
            <li><strong>Avocat</strong> : 100% avant ouverture dossier (honoraires)</li>
            <li><strong>Restaurant</strong> : 20â‚¬/personne pour groupe > 10</li>
            <li><strong>Coiffeur</strong> : 20â‚¬ pour coloration complexe</li>
          </ul>
        </div>
      </div>

      <!-- MVP-02 : WhatsApp Business -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘02 Â· Feature : WhatsApp Business API (Universel)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que client (garage/hÃ´tel/coiffeur), je veux recevoir confirmations/rappels via WhatsApp.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">User Stories :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li><strong>USCâ€‘08 (client)</strong> : "Je reÃ§ois confirmation de RDV/rÃ©servation/commande sur WhatsApp au lieu d'email"</li>
          <li><strong>USPâ€‘09 (pro)</strong> : "Je veux gÃ©rer conversations clients WhatsApp/SMS/Email dans une inbox unifiÃ©e"</li>
        </ul>
        <p class="text-xs font-semibold text-surface-600 mb-1 mt-2">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>IntÃ©gration Twilio Business API ou Meta WhatsApp Business API</li>
          <li>Templates de messages par type : confirmation, rappel, avis</li>
          <li>Inbox unifiÃ©e dans l'app pro : WhatsApp / SMS / Email sur un mÃªme thread client</li>
          <li>PrÃ©fÃ©rence client : <code>Contact.preferred_channel</code> (whatsapp|sms|email)</li>
          <li>Fallback automatique si WhatsApp Ã©choue â†’ SMS â†’ Email</li>
          <li>Tracking <code>MessageLog</code> : statut (sent, delivered, read, failed)</li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">ğŸ’¬ Templates mÃ©tiers :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage</strong> : "Votre Renault est prÃªte ! Facture : 350â‚¬"</li>
            <li><strong>HÃ´tel</strong> : "Check-in demain 14h, chambre 302"</li>
            <li><strong>Coiffeur</strong> : "RDV coupe jeudi 10h avec Marie"</li>
            <li><strong>Dentiste</strong> : "Rappel RDV dÃ©tartrage lundi 9h"</li>
          </ul>
        </div>
      </div>

      <!-- MVP-03 : Planning Ressources Universel -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘03 Â· Feature : Planning Ressources (Universel)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que tenant, je veux planifier mes ressources (mÃ©canos/chambres/stylistes/praticiens) sur calendrier drag-drop.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Table <code>ResourceSchedule</code> : tenant_id, resource_type, resource_id, slot_start, slot_end, service_order_id</li>
          <li>Types de ressources : <code>ENUM (mechanic, room, stylist, doctor, equipment, team)</code></li>
          <li>Vue calendrier : jour / semaine / mois</li>
          <li>Drag & drop pour rÃ©assigner slots</li>
          <li>DÃ©tection conflits : alerte si ressource dÃ©jÃ  bookÃ©e</li>
          <li>Couleur par statut : planifiÃ© (bleu), en cours (orange), terminÃ© (vert)</li>
          <li>Sync temps rÃ©el (Realtime Supabase)</li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">ğŸ“… Ressources selon mÃ©tier :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage</strong> : MÃ©caniciens, ponts Ã©lÃ©vateurs</li>
            <li><strong>HÃ´tel</strong> : Chambres, personnel housekeeping</li>
            <li><strong>Coiffeur</strong> : Stylistes, fauteuils</li>
            <li><strong>Dentiste</strong> : Praticiens, fauteuils, Ã©quipement radio</li>
            <li><strong>Paysagiste</strong> : Ã‰quipes terrain, machines</li>
          </ul>
        </div>
      </div>

      <!-- MVP-04 : Gestion Inventaire -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘04 Â· Feature : Gestion Inventaire (Si applicable)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que tenant avec inventaire (garage/restaurant/esthÃ©tique/coiffeur), je veux suivre mon stock et recevoir alertes rupture.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Table <code>InventoryItem</code> : tenant_id, item_type, name, reference, quantity, min_threshold, unit</li>
          <li>Types d'items : <code>ENUM (spare_part, food, beverage, cosmetic, hair_product, medical_supply)</code></li>
          <li>Alerte auto si <code>quantity &lt; min_threshold</code> â†’ notification pro</li>
          <li>Historique mouvements : <code>InventoryMovement</code> (in, out, adjustment)</li>
          <li>IntÃ©gration avec <code>ServiceOrder</code> : dÃ©duction auto stock aprÃ¨s service</li>
          <li>Dashboard inventaire : vue par catÃ©gorie, recherche, filtres</li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">ğŸ“¦ Stock selon mÃ©tier :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage</strong> : PiÃ¨ces dÃ©tachÃ©es (freins, filtres, huiles)</li>
            <li><strong>Restaurant</strong> : DenrÃ©es, boissons</li>
            <li><strong>EsthÃ©tique</strong> : Produits de soin, consommables</li>
            <li><strong>Coiffeur</strong> : Produits capillaires, teintures</li>
            <li><strong>Dentiste</strong> : MatÃ©riel mÃ©dical usage unique</li>
            <li><strong class="text-rose-700">âš ï¸ N/A</strong> : Avocat, MÃ©decin gÃ©nÃ©raliste (pas de stock physique)</li>
          </ul>
        </div>
      </div>

      <!-- MVP-05 : Ordre de Service Universel -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘05 Â· Feature : Ordre de Service (Universel)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que tenant, je veux convertir devis acceptÃ© en ordre de service pour tracker avancement.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Table <code>ServiceOrder</code> : tenant_id, entity_id, order_type, status, assigned_user_id, started_at, completed_at</li>
          <li>Types d'ordres : <code>ENUM (repair, cleaning, meal, treatment, legal_case, landscaping)</code></li>
          <li>Statuts : <code>draft â†’ in_progress â†’ completed â†’ billed</code></li>
          <li>Conversion auto depuis <code>Order</code> acceptÃ© â†’ <code>ServiceOrder</code></li>
          <li>Assignation ressource : <code>assigned_user_id</code> (collaborateur)</li>
          <li>Tracking temps rÃ©el : notifications push aux clients sur changement statut</li>
          <li>Lien avec <code>ResourceSchedule</code> pour planning</li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">ğŸ”§ Ordre de service = :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage</strong> : Ordre de RÃ©paration (OR)</li>
            <li><strong>HÃ´tel</strong> : Ordre de Housekeeping</li>
            <li><strong>Restaurant</strong> : Commande cuisine</li>
            <li><strong>Paysagiste</strong> : Ordre de chantier</li>
            <li><strong>Dentiste</strong> : Plan de traitement</li>
            <li><strong>Coiffeur</strong> : Fiche prestation</li>
          </ul>
        </div>
      </div>

      <!-- MVP-06 : Mode Offline Mobile -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘06 Â· Feature : Mode Offline Mobile (Universel)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro mobile (garage atelier, hÃ´tel rÃ©ception, coiffeur salon, paysagiste chantier), je veux accÃ©der aux fiches clients sans rÃ©seau.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">CritÃ¨res d'acceptation (NFR) :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Cache local Flutter (Hive/Isar) : derniÃ¨res 7 jours de donnÃ©es</li>
          <li>Entities cachÃ©es : <code>Contact</code>, <code>Entity</code>, <code>Order</code>, <code>ServiceOrder</code></li>
          <li>Mode read-only offline : consultation fiches clients, historique, devis</li>
          <li>Queue d'actions offline : crÃ©ations/modifications en attente sync</li>
          <li>Sync automatique dÃ¨s connexion restaurÃ©e (Realtime Supabase)</li>
          <li>Indicateur UI : badge "Offline" + compteur actions en queue</li>
          <li>RÃ©solution conflits : last-write-wins avec backup version</li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">ğŸ“± Cas d'usage mÃ©tiers :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage</strong> : MÃ©canicien consulte fiche vÃ©hicule dans atelier sans WiFi</li>
            <li><strong>HÃ´tel</strong> : RÃ©ceptionniste accÃ¨de rÃ©servations pendant coupure rÃ©seau</li>
            <li><strong>Paysagiste</strong> : Chef d'Ã©quipe consulte plan chantier sur site isolÃ©</li>
            <li><strong>Coiffeur</strong> : Styliste voit historique client mÃªme en 4G instable</li>
          </ul>
        </div>
      </div>

      <!-- MVP-07 : Rappels Automatiques MÃ©tiers -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘07 Â· Feature : Rappels Automatiques (Universel)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">L'IA calcule rappels mÃ©tier selon rÃ¨gles tenant. Client reÃ§oit rappels SMS/Email/WhatsApp.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">User Stories :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li><strong>USAâ€‘06 (AI)</strong> : "L'IA calcule rappels mÃ©tier selon rÃ¨gles tenant"</li>
          <li><strong>USCâ€‘09 (client)</strong> : "Je reÃ§ois rappels SMS/Email/WhatsApp (vidange J-30, rÃ©sa J-7, coupe J+45)"</li>
        </ul>
        <p class="text-xs font-semibold text-surface-600 mb-1 mt-2">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Table <code>AutomatedReminder</code> : tenant_id, contact_id, reminder_type, trigger_rule, next_send_date</li>
          <li>Types de rappels : <code>ENUM (maintenance, booking, follow_up, deadline, renewal)</code></li>
          <li>RÃ¨gles configurables par mÃ©tier : frÃ©quence, dÃ©lai avant event, conditions</li>
          <li>Job cron quotidien : dÃ©tecte rappels Ã  envoyer, appelle <code>MessageService</code></li>
          <li>Template personnalisable par tenant</li>
          <li>Opt-out client : <code>Contact.reminder_enabled</code> (RGPD)</li>
          <li>Tracking envois : <code>ReminderLog</code> (sent_at, channel, status)</li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">ğŸ”” Rappels selon mÃ©tier :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage</strong> : Vidange J-30, ContrÃ´le technique J-60</li>
            <li><strong>HÃ´tel</strong> : Offres fidÃ©litÃ©, Anniversaire sÃ©jour +1 an</li>
            <li><strong>Coiffeur</strong> : Coupe tous les 45j, Coloration 6 semaines</li>
            <li><strong>Dentiste</strong> : ContrÃ´le tous les 6 mois, DÃ©tartrage annuel</li>
            <li><strong>Avocat</strong> : Deadlines procÃ©dure J-7, Renouvellement mandat</li>
          </ul>
        </div>
      </div>

      <!-- MVP-08 : Avis Clients Auto -->
      <div class="us-card border-l-violet-400 bg-violet-50/30 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">MVPâ€‘08 Â· Feature : Avis Clients Automatiques (Universel)</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que tenant, j'envoie demandes avis automatiques post-service sur la plateforme de mon mÃ©tier.</p>
        <p class="text-xs font-semibold text-surface-600 mb-1">CritÃ¨res d'acceptation :</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Table <code>Review</code> : tenant_id, contact_id, service_order_id, platform, rating, comment, status</li>
          <li>Plateformes : <code>ENUM (google, booking, tripadvisor, doctolib, trustpilot, yelp)</code></li>
          <li>Trigger auto : J+3 aprÃ¨s <code>ServiceOrder.status = completed</code></li>
          <li>Email/SMS/WhatsApp avec lien direct vers plateforme avis</li>
          <li>Config tenant : plateforme prÃ©fÃ©rÃ©e, dÃ©lai envoi, template message</li>
          <li>Dashboard avis : score moyen, rÃ©partition, derniers commentaires</li>
          <li>IntÃ©gration Google My Business API (lecture/rÃ©ponse avis)</li>
        </ul>
        <div class="mt-3 bg-violet-100/50 rounded-lg p-3 text-xs">
          <p class="font-semibold text-violet-900 mb-1">â­ Plateformes mÃ©tiers :</p>
          <ul class="text-violet-800 space-y-0.5 list-disc pl-4">
            <li><strong>Garage/Coiffeur/EsthÃ©tique</strong> : Google Reviews, Yelp</li>
            <li><strong>HÃ´tel</strong> : Booking.com, TripAdvisor, Google</li>
            <li><strong>Restaurant</strong> : Google, TheFork, TripAdvisor</li>
            <li><strong>Dentiste/MÃ©decin</strong> : Doctolib, Google</li>
            <li><strong>Avocat</strong> : Trustpilot, Avvo, Google</li>
          </ul>
        </div>
      </div>
    </div>
  </div>


  <!-- â”€â”€â”€â”€ MODULE BILLING â”€â”€â”€â”€ -->
  <div class="card p-6 mb-6">
    <h3 class="text-base font-bold text-surface-900 mb-1 flex items-center gap-2">
      <span class="w-3 h-3 rounded bg-accent-amber"></span> Module : billing
    </h3>
    <p class="text-xs text-surface-400 mb-5">Forfaits, quotas, crÃ©dits IA, facturation Stripe</p>

    <div class="space-y-4">
      <div class="us-card border-l-accent-amber bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘B01 Â· admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant qu'admin, je veux voir ma consommation courante (appels API, crÃ©dits IA) et mon forfait afin de maÃ®triser mes coÃ»ts.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Dashboard billing affichant : forfait actuel, usage du mois (appels API, tokens IA), % du quota consommÃ©.</li>
          <li>Alerte visuelle quand le quota dÃ©passe 80 % et 95 %.</li>
          <li>Historique des factures tÃ©lÃ©chargeables (PDF).</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-amber bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘B02 Â· admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant qu'admin, je veux changer de forfait (upgrade/downgrade) afin d'adapter mon abonnement Ã  mon activitÃ©.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Le changement est effectif au prochain cycle de facturation (prorata calculÃ©).</li>
          <li>Stripe gÃ¨re le changement de plan via l'API Subscriptions.</li>
          <li>Confirmation par email avec rÃ©capitulatif du nouveau plan.</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-amber bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘B03 Â· admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant qu'admin, je veux acheter des crÃ©dits IA supplÃ©mentaires afin de ne pas Ãªtre bloquÃ© en cas de dÃ©passement de quota.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Packs de crÃ©dits prÃ©dÃ©finis (ex : 100, 500, 1000 crÃ©dits).</li>
          <li>Paiement oneâ€‘shot via Stripe Checkout. CrÃ©dits ajoutÃ©s immÃ©diatement.</li>
          <li>Les crÃ©dits supplÃ©mentaires n'expirent pas (valides tant que le tenant existe).</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-amber bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘B04 Â· systÃ¨me</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que systÃ¨me, je veux logger chaque appel API facturÃ© dans UsageLog afin de calculer la facture mensuelle de chaque tenant.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Chaque appel crÃ©e une entrÃ©e avec : tenant_id, module, action, coÃ»t unitaire, timestamp.</li>
          <li>Le calcul de la facture agrÃ¨ge les UsageLog du mois par tenant.</li>
          <li>Les logs sont immutables (pas de UPDATE, pas de DELETE).</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-amber bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘B05 Â· admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant qu'admin, je veux gÃ©rer mon moyen de paiement (carte bancaire) afin de maintenir ma facturation Ã  jour.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Gestion via Stripe Customer Portal (aucune donnÃ©e carte stockÃ©e cÃ´tÃ© Vision CRM).</li>
          <li>Notification en cas d'Ã©chec de paiement avec lien de mise Ã  jour.</li>
          <li>Suspension du compte aprÃ¨s 3 Ã©checs consÃ©cutifs (avec avertissements progressifs).</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- â”€â”€â”€â”€ MODULE AI â”€â”€â”€â”€ -->
  <div class="card p-6">
    <h3 class="text-base font-bold text-surface-900 mb-1 flex items-center gap-2">
      <span class="w-3 h-3 rounded bg-accent-violet"></span> Module : ai
    </h3>
    <p class="text-xs text-surface-400 mb-5">Analyse tenantâ€‘aware, gÃ©nÃ©ration, suggestions</p>

    <div class="space-y-4">
      <div class="us-card border-l-accent-violet bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘A01 Â· admin / pro</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro, je veux gÃ©nÃ©rer automatiquement un descriptif d'intervention Ã  partir des piÃ¨ces et opÃ©rations sÃ©lectionnÃ©es afin de gagner du temps sur la rÃ©daction.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Le texte est gÃ©nÃ©rÃ© en &lt; 3 s Ã  partir du contexte (entitÃ© mÃ©tier, piÃ¨ces, opÃ©rations).</li>
          <li>Le pro peut Ã©diter le texte gÃ©nÃ©rÃ© avant validation.</li>
          <li>Chaque gÃ©nÃ©ration consomme des crÃ©dits IA, loguÃ©e dans UsageLog.</li>
          <li>Le modÃ¨le IA n'a accÃ¨s qu'aux donnÃ©es du tenant courant (tenantâ€‘aware).</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-violet bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘A02 Â· admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant qu'admin, je veux voir un tableau de bord analytique IA (tendances, piÃ¨ces les plus commandÃ©es, clients Ã  relancer) afin de piloter mon activitÃ©.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Widgets : top 10 piÃ¨ces, CA mensuel tendanciel, taux de conversion devis, clients inactifs > 6 mois.</li>
          <li>Les donnÃ©es sont calculÃ©es uniquement Ã  partir des donnÃ©es du tenant.</li>
          <li>RafraÃ®chissement quotidien (batch) ou Ã  la demande (crÃ©dits IA).</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-violet bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘A03 Â· admin / pro</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro, je veux recevoir des suggestions intelligentes (piÃ¨ces souvent associÃ©es, rappels entretien) afin d'augmenter le panier moyen.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Suggestions affichÃ©es dans la fiche entitÃ© mÃ©tier et dans le devis (encart non intrusif).</li>
          <li>BasÃ©es sur l'historique du tenant et les corrÃ©lations piÃ¨ces/entitÃ©s mÃ©tiers.</li>
          <li>PossibilitÃ© de dÃ©sactiver les suggestions dans les paramÃ¨tres du module.</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-violet bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘A04 Â· admin / pro</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que pro, je veux gÃ©nÃ©rer un SMS ou email de relance personnalisÃ© pour un client afin de l'inciter Ã  prendre RDV.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>L'IA rÃ©dige un message adaptÃ© (nom du client, entitÃ© mÃ©tier, derniÃ¨re intervention, entretien Ã  prÃ©voir).</li>
          <li>Le pro valide avant envoi (pas d'envoi automatique MVP).</li>
          <li>Conforme RGPD : le client doit avoir consenti aux communications commerciales.</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-violet bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘A05 Â· admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant qu'admin, je veux consulter ma consommation IA dÃ©taillÃ©e (tokens utilisÃ©s, crÃ©dits restants) afin de contrÃ´ler mon budget IA.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Affichage : crÃ©dits restants, historique d'utilisation par jour/semaine, coÃ»t par type d'opÃ©ration.</li>
          <li>Alerte configurable Ã  un seuil personnalisÃ© (ex : 50 crÃ©dits restants).</li>
          <li>Lien direct vers l'achat de crÃ©dits supplÃ©mentaires (module billing).</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- â”€â”€â”€â”€ SUPER ADMIN (PLATEFORME) â”€â”€â”€â”€ -->
  <div class="card p-6">
    <h3 class="text-base font-bold text-surface-900 mb-1 flex items-center gap-2">
      <span class="w-3 h-3 rounded bg-accent-cyan"></span> RÃ´le : super_admin (plateforme)
    </h3>
    <p class="text-xs text-surface-400 mb-5">Monitoring, gestion tenants, billing global, feature flags</p>

    <div class="space-y-4">
      <div class="us-card border-l-accent-cyan bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘SA01 Â· super_admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que super_admin, je veux voir un dashboard global de la plateforme (MRR, tenants actifs, churn, usage IA) afin de piloter le business.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>KPIs calculÃ©s en temps rÃ©el (ou cache < 5 min) : MRR, nb tenants actifs, churn mensuel.</li>
          <li>Graphiques : Ã©volution MRR 12 mois, usage par module, rÃ©partition plans.</li>
          <li>Le dashboard ne charge aucune donnÃ©e mÃ©tier spÃ©cifique Ã  un tenant (pas de PII).</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-cyan bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘SA02 Â· super_admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que super_admin, je veux impersonate un tenant afin de dÃ©bugger un problÃ¨me ou aider un client en support.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>L'impersonation gÃ©nÃ¨re un token temporaire (TTL 30 min, non renouvelable).</li>
          <li>Toute action effectuÃ©e pendant l'impersonation est loguÃ©e dans l'audit avec le flag <code>impersonated_by: super_admin_id</code>.</li>
          <li>Le super_admin voit une banniÃ¨re visible Â« Mode impersonation â€” Tenant : [nom] Â» en haut de l'Ã©cran.</li>
          <li>L'impersonation ne permet pas de modifier le plan, les clÃ©s API ou de supprimer des donnÃ©es.</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-cyan bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘SA03 Â· super_admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que super_admin, je veux gÃ©rer les feature flags pour activer/dÃ©sactiver un module globalement ou par rollout progressif.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Chaque module a un flag : enabled (global), disabled (global), rollout (% de tenants).</li>
          <li>Les changements de flag sont instantanÃ©s (pas besoin de redÃ©ploiement).</li>
          <li>Historique des changements de flags avec auteur et timestamp.</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-cyan bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘SA04 Â· super_admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que super_admin, je veux suspendre ou rÃ©activer un tenant afin de gÃ©rer les impayÃ©s ou les abus.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>La suspension bloque l'accÃ¨s Ã  l'app pour tous les users du tenant (code 403 + message).</li>
          <li>Les donnÃ©es ne sont pas supprimÃ©es, le tenant peut Ãªtre rÃ©activÃ© Ã  tout moment.</li>
          <li>Notification email automatique au propriÃ©taire du tenant (admin) lors de la suspension.</li>
          <li>AprÃ¨s 90 jours de suspension, alerte au super_admin pour dÃ©cision de suppression dÃ©finitive.</li>
        </ul>
      </div>

      <div class="us-card border-l-accent-cyan bg-surface-50 rounded-r-xl p-4">
        <p class="text-xs font-mono text-surface-400 mb-1">USâ€‘SA05 Â· super_admin</p>
        <p class="text-sm font-semibold text-surface-900 mb-2">En tant que super_admin, je veux consulter les logs d'audit crossâ€‘tenant afin de tracer les actions sensibles et rÃ©pondre aux incidents.</p>
        <ul class="ac-list text-xs text-surface-600 space-y-0.5 list-none pl-0">
          <li>Filtres : tenant, utilisateur, type d'action, plage de dates, sÃ©vÃ©ritÃ©.</li>
          <li>Export CSV/JSON pour analyse externe.</li>
          <li>Les logs d'audit sont immutables et conservÃ©s 12 mois minimum.</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     08 â€” WIREFRAMES FONCTIONNELS (TEXTE)
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="wireframes">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">08</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Wireframes fonctionnels</h2>
  </div>
  <p class="text-sm text-surface-500 mb-6">Description textuelle des Ã©crans clÃ©s. DestinÃ©e au designer (maquettes Figma) et au dev Flutter (implÃ©mentation). Chaque wireframe dÃ©crit le layout, les blocs de contenu et les actions principales.</p>

  <!-- WF 1 â€” Dashboard pro -->
  <div class="card p-6 mb-6">
    <h3 class="text-base font-bold text-surface-900 mb-1">ğŸ–¥ï¸ Ã‰cran 1 â€” Dashboard pro</h3>
    <p class="text-xs text-surface-400 mb-4">Point d'entrÃ©e aprÃ¨s connexion du pro / admin. Vue d'ensemble de l'activitÃ© du tenant mÃ©tier.</p>

    <div class="grid md:grid-cols-2 gap-4 text-xs">
      <div>
        <p class="font-semibold text-surface-800 mb-2">Layout</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Sidebar gauche (fixe, 240 px) :</strong> Logo du tenant, navigation principale (Dashboard, Clients, entitÃ©s mÃ©tiers, Devis, Modules, ParamÃ¨tres), indicateur forfait/quotas en bas, avatar + nom de l'utilisateur connectÃ©.</p>
          <p><strong>Header top (sticky) :</strong> Fil d'ariane, barre de recherche globale (clients, plaques, ID mÃ©tier), bouton notifications (cloche + badge compteur), bouton Â« + Nouveau Â» (dropdown : nouveau client, nouveau devis, recherche entitÃ© mÃ©tier).</p>
          <p><strong>Zone principale :</strong> Grille responsive de widgets (2 colonnes desktop, 1 colonne mobile).</p>
        </div>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-2">Blocs de contenu (widgets)</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>KPI row (4 cartes) :</strong> CA du mois, Devis en attente, Interventions en cours, CrÃ©dits IA restants.</p>
          <p><strong>Devis rÃ©cents (tableau) :</strong> Colonnes : client, entitÃ© mÃ©tier, montant TTC, statut (badge couleur), date. Actions : voir, Ã©diter, dupliquer.</p>
          <p><strong>Interventions du jour (liste) :</strong> entitÃ© mÃ©tier, type d'intervention, ressource mÃ©tier assignÃ©, progression (barre).</p>
          <p><strong>ActivitÃ© rÃ©cente (feed) :</strong> Timeline des derniÃ¨res actions (nouveau client, devis acceptÃ©, paiement reÃ§uâ€¦).</p>
          <p><strong>Suggestions IA (encart) :</strong> Clients Ã  relancer, entretiens Ã  venir, piÃ¨ces en rupture.</p>
        </div>
      </div>
    </div>
    <div class="mt-4">
      <p class="font-semibold text-surface-800 mb-1 text-xs">Actions principales (CTA)</p>
      <div class="flex flex-wrap gap-2 text-xs">
        <span class="bg-brand-600 text-white px-3 py-1.5 rounded-lg font-medium">+ Nouveau devis</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">recherche entitÃ© mÃ©tier</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Voir tous les devis</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Exporter CA (CSV)</span>
      </div>
    </div>
  </div>

  <!-- WF 2 â€” recherche entitÃ© mÃ©tier / ID mÃ©tier -->
  <div class="card p-6 mb-6">
    <h3 class="text-base font-bold text-surface-900 mb-1">ğŸ” Ã‰cran 2 â€” Recherche par plaque / ID mÃ©tier</h3>
    <p class="text-xs text-surface-400 mb-4">Ã‰cran central du module tenant mÃ©tier. Permet d'identifier un entitÃ© mÃ©tier et accÃ©der Ã  ses piÃ¨ces.</p>

    <div class="grid md:grid-cols-2 gap-4 text-xs">
      <div>
        <p class="font-semibold text-surface-800 mb-2">Layout</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Zone haute (hero) :</strong> Grand champ de saisie centrÃ© avec placeholder Â« Entrez une plaque (AA-123-BB) ou un ID mÃ©tier Â». Toggle plaque / ID mÃ©tier. Bouton Â« Rechercher Â». Animation de chargement pendant l'appel API.</p>
          <p><strong>Zone rÃ©sultat (apparaÃ®t aprÃ¨s recherche) :</strong> Carte entitÃ© mÃ©tier identifiÃ© (marque, modÃ¨le, version, motorisation, annÃ©e, couleur si dispo). Bouton Â« Enregistrer ce entitÃ© mÃ©tier Â» si pas encore dans la base. Bouton Â« Voir les piÃ¨ces compatibles Â».</p>
          <p><strong>Zone piÃ¨ces (accordÃ©on) :</strong> Arbre de catÃ©gories (Freinage, Filtration, Embrayageâ€¦). Chaque catÃ©gorie s'ouvre sur la liste des piÃ¨ces avec ref, fabricant, prix, stock.</p>
        </div>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-2">Ã‰tats et cas limites</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Ã‰tat vide :</strong> Illustration + texte Â« Cherchez un entitÃ© mÃ©tier pour commencer Â».</p>
          <p><strong>Chargement :</strong> Skeleton loader sur la carte entitÃ© mÃ©tier.</p>
          <p><strong>Erreur plaque invalide :</strong> Message inline sous le champ, bordure rouge.</p>
          <p><strong>entitÃ© mÃ©tier non trouvÃ© :</strong> Message + CTA Â« Ajouter manuellement Â».</p>
          <p><strong>API tierce indisponible :</strong> BanniÃ¨re warning Â« Service TechAlliance temporairement indisponible, veuillez rÃ©essayer Â».</p>
        </div>
      </div>
    </div>
    <div class="mt-4">
      <p class="font-semibold text-surface-800 mb-1 text-xs">Actions principales (CTA)</p>
      <div class="flex flex-wrap gap-2 text-xs">
        <span class="bg-brand-600 text-white px-3 py-1.5 rounded-lg font-medium">Rechercher</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Enregistrer entitÃ© mÃ©tier</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Ajouter item au devis</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">CrÃ©er devis depuis ces piÃ¨ces</span>
      </div>
    </div>
  </div>

  <!-- WF 3 â€” Modules & extensions -->
  <div class="card p-6 mb-6">
    <h3 class="text-base font-bold text-surface-900 mb-1">ğŸ§© Ã‰cran 3 â€” Modules & extensions</h3>
    <p class="text-xs text-surface-400 mb-4">Gestion des modules activÃ©s et de leurs configurations. RÃ©servÃ© admin.</p>

    <div class="grid md:grid-cols-2 gap-4 text-xs">
      <div>
        <p class="font-semibold text-surface-800 mb-2">Layout</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Header section :</strong> Titre Â« Modules & extensions Â», sousâ€‘titre Â« Activez ou dÃ©sactivez les modules pour votre espace Â».</p>
          <p><strong>Grille de modules (cards) :</strong> Chaque card : icÃ´ne, nom du module, description courte, badge statut (actif / inactif / bÃªta), toggle on/off.</p>
          <p><strong>Panneau de configuration (slideâ€‘over droit) :</strong> S'ouvre quand on clique Â« Configurer Â» sur un module actif. Contenu dynamique selon le module : champs clÃ©s API (masquÃ©s), paramÃ¨tres spÃ©cifiques, bouton Â« Tester la connexion Â», bouton Â« Sauvegarder Â».</p>
        </div>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-2">Blocs de contenu</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Section Â« Modules natifs Â» :</strong> tenant mÃ©tier, billing, ai â€” toujours visibles, certains inclus dans le forfait.</p>
          <p><strong>Section Â« IntÃ©grations B2B Â» :</strong> TechAlliance, TecDoc, HaynesPro, Shopify, etc. â€” activables avec clÃ©s API.</p>
          <p><strong>Section Â« Marketplace Â» (postâ€‘MVP) :</strong> Modules tiers ou communautaires.</p>
          <p><strong>Indicateur billing :</strong> Ã€ cÃ´tÃ© de chaque module, coÃ»t additionnel mensuel ou Â« inclus dans le forfait Â».</p>
        </div>
      </div>
    </div>
    <div class="mt-4">
      <p class="font-semibold text-surface-800 mb-1 text-xs">Actions principales</p>
      <div class="flex flex-wrap gap-2 text-xs">
        <span class="bg-brand-600 text-white px-3 py-1.5 rounded-lg font-medium">Activer module</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Configurer</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Tester la connexion</span>
        <span class="bg-accent-rose/10 text-accent-rose px-3 py-1.5 rounded-lg">DÃ©sactiver</span>
      </div>
    </div>
  </div>

  <!-- WF 4 â€” Billing & quotas -->
  <div class="card p-6 mb-6">
    <h3 class="text-base font-bold text-surface-900 mb-1">ğŸ’³ Ã‰cran 4 â€” Billing & quotas IA</h3>
    <p class="text-xs text-surface-400 mb-4">Vue complÃ¨te de la facturation, usage et gestion du forfait. RÃ©servÃ© admin.</p>

    <div class="grid md:grid-cols-2 gap-4 text-xs">
      <div>
        <p class="font-semibold text-surface-800 mb-2">Layout</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Enâ€‘tÃªte :</strong> Nom du forfait actuel (badge), date de renouvellement, bouton Â« Changer de forfait Â».</p>
          <p><strong>Section usage (graphiques) :</strong> Barre de progression : quotas API consommÃ©s (x / max). Barre de progression : crÃ©dits IA consommÃ©s (x / max). Graphique linÃ©aire : usage quotidien sur 30 j.</p>
          <p><strong>Section factures (tableau) :</strong> Colonnes : pÃ©riode, montant, statut (payÃ©e / en attente / Ã©chouÃ©e), lien PDF.</p>
          <p><strong>Section paiement :</strong> Carte bancaire enregistrÃ©e (masquÃ©e **** 4242), bouton Â« Modifier Â» (â†’ Stripe Portal).</p>
        </div>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-2">Blocs spÃ©cifiques</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Alerte dÃ©passement :</strong> BanniÃ¨re orange si quota > 80 %, rouge si > 95 %. CTA : Â« Acheter des crÃ©dits Â» ou Â« Upgrader Â».</p>
          <p><strong>DÃ©tail par module :</strong> Tableau ventilÃ© : module (tenant mÃ©tier, ai, â€¦), nb appels, coÃ»t unitaire, total du mois.</p>
          <p><strong>Achat crÃ©dits IA :</strong> Cards avec packs (100 / 500 / 1000 crÃ©dits), prix, bouton Â« Acheter Â» â†’ Stripe Checkout.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- WF 5 â€” Dashboard client -->
  <div class="card p-6">
    <h3 class="text-base font-bold text-surface-900 mb-1">ğŸ‘¤ Ã‰cran 5 â€” Dashboard client</h3>
    <p class="text-xs text-surface-400 mb-4">Vue simplifiÃ©e pour le client final (rÃ´le <code>client</code>). Selfâ€‘service, lecture seule sauf validation devis.</p>

    <div class="grid md:grid-cols-2 gap-4 text-xs">
      <div>
        <p class="font-semibold text-surface-800 mb-2">Layout</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Header simplifiÃ© :</strong> Logo du tenant mÃ©tier, nom du client, bouton Â« Mon profil Â», bouton dÃ©connexion.</p>
          <p><strong>Navigation simplifiÃ©e (tabs ou bottom nav mobile) :</strong> Mes entitÃ©s mÃ©tiers, Mes devis, Historique, Notifications.</p>
          <p><strong>Zone principale :</strong> Contenu de l'onglet sÃ©lectionnÃ©.</p>
        </div>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-2">Blocs de contenu</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Mes entitÃ©s mÃ©tiers (cards) :</strong> Plaque, marque/modÃ¨le, kilomÃ©trage, prochaine Ã©chÃ©ance (CT, vidangeâ€¦). Tap â†’ dÃ©tail + historique.</p>
          <p><strong>Mes devis (liste) :</strong> Date, tenant mÃ©tier, montant, statut. CTA : Â« Voir le dÃ©tail Â» / Â« Accepter Â» / Â« Refuser Â».</p>
          <p><strong>Historique (timeline) :</strong> Toutes les interventions passÃ©es, triÃ©es par date. Chaque entrÃ©e : date, nature, coÃ»t total.</p>
          <p><strong>Notifications :</strong> Rappels entretien, devis reÃ§u, intervention terminÃ©e.</p>
        </div>
      </div>
    </div>
    <div class="mt-4">
      <p class="font-semibold text-surface-800 mb-1 text-xs">Actions principales</p>
      <div class="flex flex-wrap gap-2 text-xs">
        <span class="bg-accent-emerald text-white px-3 py-1.5 rounded-lg font-medium">Accepter devis</span>
        <span class="bg-accent-rose/10 text-accent-rose px-3 py-1.5 rounded-lg">Refuser devis</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Voir historique entitÃ© mÃ©tier</span>
      </div>
    </div>
  </div>

  <!-- WF 6 â€” Back-office super_admin -->
  <div class="card p-6">
    <h3 class="text-base font-bold text-surface-900 mb-1">ğŸ›¡ï¸ Ã‰cran 6 â€” Backâ€‘office super_admin</h3>
    <p class="text-xs text-surface-400 mb-4">Tableau de bord plateforme. RÃ©servÃ© au rÃ´le <code>super_admin</code>. Monitoring, billing global, gestion tenants.</p>

    <div class="grid md:grid-cols-2 gap-4 text-xs">
      <div>
        <p class="font-semibold text-surface-800 mb-2">Layout</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>Sidebar gauche (fixe) :</strong> Logo Vision CRM, navigation : Dashboard, Tenants, Modules, Billing global, Audit logs, Feature flags, ParamÃ¨tres. Badge Â« super_admin Â» visible.</p>
          <p><strong>Header :</strong> Barre de recherche (tenants par nom/slug/email), notifications systÃ¨me (alertes paiement, erreurs API, health checks), indicateur santÃ© plateforme (ğŸŸ¢ OK / ğŸŸ¡ dÃ©gradÃ© / ğŸ”´ incident).</p>
          <p><strong>Zone principale :</strong> Vue contextuelle selon l'onglet de navigation.</p>
        </div>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-2">Blocs de contenu</p>
        <div class="wf-block space-y-2 text-surface-600">
          <p><strong>KPI row (5 cartes) :</strong> MRR (Monthly Recurring Revenue), nombre de tenants actifs, churn rate mensuel, crÃ©dits IA consommÃ©s (global), taux d'erreur API 24 h.</p>
          <p><strong>Liste tenants (tableau) :</strong> Colonnes : nom, plan, usage mois (%), crÃ©dits IA restants, derniÃ¨re activitÃ©, statut. Actions : voir dÃ©tail, impersonate, suspendre.</p>
          <p><strong>Graphiques :</strong> MRR evolution (12 mois), usage API par module (stacked bar), rÃ©partition tenants par plan (pie chart), top 10 tenants par consommation.</p>
          <p><strong>Audit logs (feed) :</strong> Actions sensibles crossâ€‘tenant : changements plan, impersonations, suppressions, erreurs de paiement. Filtres : tenant, user, action, date range.</p>
          <p><strong>Feature flags :</strong> Toggle global pour chaque module. Rollout progressif possible (% de tenants). Historique des changements.</p>
        </div>
      </div>
    </div>
    <div class="mt-4">
      <p class="font-semibold text-surface-800 mb-1 text-xs">Actions principales</p>
      <div class="flex flex-wrap gap-2 text-xs">
        <span class="bg-cyan-600 text-white px-3 py-1.5 rounded-lg font-medium">Impersonate tenant</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">CrÃ©diter crÃ©dits IA</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Changer plan tenant</span>
        <span class="bg-surface-200 text-surface-700 px-3 py-1.5 rounded-lg">Exporter metrics (CSV)</span>
        <span class="bg-accent-rose/10 text-accent-rose px-3 py-1.5 rounded-lg">Suspendre tenant</span>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     09 â€” SPÃ‰CIFICATIONS DATA & API
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="dataapi">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">09</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">SpÃ©cifications data & API</h2>
  </div>

  <!-- â”€â”€â”€â”€ DATA MODELS â”€â”€â”€â”€ -->
  <h3 class="text-lg font-bold text-surface-900 mb-4">9.1 â€” SchÃ©ma des entitÃ©s</h3>

  <!-- Tenant -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-surface-900 text-white flex items-center gap-2"><span class="font-mono text-sm font-bold">Tenant</span><span class="text-surface-400 text-xs">â€” Espace client (tenant mÃ©tier, boutiqueâ€¦)</span></div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>Identifiant unique</td><td>PK, autoâ€‘gÃ©nÃ©rÃ©</td></tr>
        <tr><td><code>name</code></td><td>VARCHAR(255)</td><td>Nom commercial du tenant</td><td>NOT NULL</td></tr>
        <tr><td><code>slug</code></td><td>VARCHAR(100)</td><td>Identifiant URLâ€‘friendly</td><td>UNIQUE, NOT NULL, index</td></tr>
        <tr><td><code>logo_url</code></td><td>TEXT</td><td>URL du logo</td><td>NULLABLE</td></tr>
        <tr><td><code>siret</code></td><td>VARCHAR(14)</td><td>NumÃ©ro SIRET</td><td>NULLABLE, UNIQUE si renseignÃ©</td></tr>
        <tr><td><code>address</code></td><td>JSONB</td><td>Adresse postale structurÃ©e</td><td>NULLABLE</td></tr>
        <tr><td><code>phone</code></td><td>VARCHAR(20)</td><td>TÃ©lÃ©phone principal</td><td>NULLABLE</td></tr>
        <tr><td><code>plan</code></td><td>ENUM</td><td>Forfait actuel (free, starter, pro, enterprise)</td><td>NOT NULL, DEFAULT 'free'</td></tr>
        <tr><td><code>stripe_customer_id</code></td><td>VARCHAR(255)</td><td>ID Stripe Customer</td><td>NULLABLE, UNIQUE</td></tr>
        <tr><td><code>stripe_subscription_id</code></td><td>VARCHAR(255)</td><td>ID Stripe Subscription active</td><td>NULLABLE, UNIQUE</td></tr>
        <tr><td><code>monthly_credits</code></td><td>INT</td><td>CrÃ©dits IA inclus dans le plan courant</td><td>NOT NULL, DEFAULT 0</td></tr>
        <tr><td><code>current_usage</code></td><td>JSONB</td><td>Compteurs d'usage courants {api_calls, ai_tokens, ai_credits_used}</td><td>NOT NULL, DEFAULT '{}'</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>Date de crÃ©ation</td><td>NOT NULL, DEFAULT now()</td></tr>
        <tr><td><code>updated_at</code></td><td>TIMESTAMPTZ</td><td>DerniÃ¨re modification</td><td>NOT NULL, autoâ€‘update</td></tr>
      </tbody>
    </table>
  </div>

  <!-- User -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-surface-800 text-white flex items-center gap-2"><span class="font-mono text-sm font-bold">User</span><span class="text-surface-400 text-xs">â€” Utilisateur (pro, admin, client)</span></div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>Identifiant unique</td><td>PK, autoâ€‘gÃ©nÃ©rÃ©</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant d'appartenance</td><td>FK â†’ Tenant.id, NOT NULL, index</td></tr>
        <tr><td><code>auth_provider_id</code></td><td>VARCHAR(255)</td><td>ID dans le provider d'auth (Supabase/Clerk)</td><td>UNIQUE, NOT NULL</td></tr>
        <tr><td><code>email</code></td><td>VARCHAR(255)</td><td>Email de connexion</td><td>NOT NULL, index</td></tr>
        <tr><td><code>full_name</code></td><td>VARCHAR(255)</td><td>Nom complet</td><td>NOT NULL</td></tr>
        <tr><td><code>role</code></td><td>ENUM</td><td>RÃ´le RBAC (super_admin, admin, pro, client)</td><td>NOT NULL, DEFAULT 'pro'</td></tr>
        <tr><td><code>avatar_url</code></td><td>TEXT</td><td>URL de l'avatar</td><td>NULLABLE</td></tr>
        <tr><td><code>is_active</code></td><td>BOOLEAN</td><td>Compte actif ou dÃ©sactivÃ©</td><td>NOT NULL, DEFAULT true</td></tr>
        <tr><td><code>last_login_at</code></td><td>TIMESTAMPTZ</td><td>DerniÃ¨re connexion</td><td>NULLABLE</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>Date de crÃ©ation</td><td>NOT NULL, DEFAULT now()</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Client -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-surface-700 text-white flex items-center gap-2"><span class="font-mono text-sm font-bold">Contact</span><span class="text-surface-300 text-xs">â€” Contact du tenant (client, prospect, particulier ou entreprise)</span></div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>Identifiant unique</td><td>PK</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant propriÃ©taire</td><td>FK, NOT NULL, index</td></tr>
        <tr><td><code>user_id</code></td><td>UUID</td><td>Lien optionnel vers User (si le client a un compte)</td><td>FK â†’ User.id, NULLABLE, UNIQUE</td></tr>
        <tr><td><code>type</code></td><td>ENUM</td><td>particulier / entreprise</td><td>NOT NULL, DEFAULT 'particulier'</td></tr>
        <tr><td><code>first_name</code></td><td>VARCHAR(100)</td><td>PrÃ©nom</td><td>NOT NULL</td></tr>
        <tr><td><code>last_name</code></td><td>VARCHAR(100)</td><td>Nom</td><td>NOT NULL</td></tr>
        <tr><td><code>company_name</code></td><td>VARCHAR(255)</td><td>Raison sociale (si entreprise)</td><td>NULLABLE</td></tr>
        <tr><td><code>email</code></td><td>VARCHAR(255)</td><td>Email de contact</td><td>NULLABLE, index</td></tr>
        <tr><td><code>phone</code></td><td>VARCHAR(20)</td><td>TÃ©lÃ©phone</td><td>NULLABLE</td></tr>
        <tr><td><code>address</code></td><td>JSONB</td><td>Adresse structurÃ©e</td><td>NULLABLE</td></tr>
        <tr><td><code>gdpr_consent</code></td><td>BOOLEAN</td><td>Consentement RGPD communications</td><td>NOT NULL, DEFAULT false</td></tr>
        <tr><td><code>preferred_channel</code></td><td>ENUM</td><td>Canal prÃ©fÃ©rÃ© (whatsapp, sms, email)</td><td>NOT NULL, DEFAULT 'email'</td></tr>
        <tr><td><code>whatsapp_number</code></td><td>VARCHAR(20)</td><td>NumÃ©ro WhatsApp</td><td>NULLABLE</td></tr>
        <tr><td><code>reminder_enabled</code></td><td>BOOLEAN</td><td>Rappels activÃ©s (RGPD)</td><td>NOT NULL, DEFAULT true</td></tr>
        <tr><td><code>notes</code></td><td>TEXT</td><td>Notes internes (non visibles par le client)</td><td>NULLABLE</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>Date de crÃ©ation</td><td>NOT NULL</td></tr>
      </tbody>
    </table>
  </div>

  
  <!-- Entity (UNIVERSEL : remplace Vehicle) -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-violet-700 text-white flex items-center gap-2">
      <span class="font-mono text-sm font-bold">Entity</span>
      <span class="text-violet-200 text-xs">â€” EntitÃ© mÃ©tier universelle (vÃ©hicule, chambre, patient, dossier...)</span>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>Identifiant unique</td><td>PK</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant propriÃ©taire</td><td>FK, NOT NULL, index</td></tr>
        <tr><td><code>contact_id</code></td><td>UUID</td><td>Contact propriÃ©taire (client)</td><td>FK â†’ Contact.id, NOT NULL, index</td></tr>
        <tr><td><code>entity_type</code></td><td>ENUM</td><td>Type d'entitÃ© mÃ©tier</td><td>NOT NULL, VALUES: vehicle, room, patient, legal_case, project, appointment</td></tr>
        <tr><td><code>primary_identifier</code></td><td>VARCHAR(100)</td><td>Identifiant principal mÃ©tier (plaque, nÂ° chambre, nÂ° dossier...)</td><td>index, UNIQUE par (tenant_id, entity_type)</td></tr>
        <tr><td><code>secondary_identifier</code></td><td>VARCHAR(100)</td><td>Identifiant secondaire (VIN, Ã©tage, rÃ©fÃ©rence interne...)</td><td>NULLABLE, index</td></tr>
        <tr><td><code>name</code></td><td>VARCHAR(255)</td><td>Nom/libellÃ© de l'entitÃ©</td><td>NOT NULL</td></tr>
        <tr><td><code>metadata</code></td><td>JSONB</td><td>DonnÃ©es mÃ©tier spÃ©cifiques (brand, model, capacity, specialization...)</td><td>NOT NULL, DEFAULT '{}'</td></tr>
        <tr><td><code>status</code></td><td>VARCHAR(50)</td><td>Statut mÃ©tier (active, archived, reserved, in_treatment...)</td><td>NOT NULL, DEFAULT 'active'</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>Date de crÃ©ation</td><td>NOT NULL, DEFAULT now()</td></tr>
        <tr><td><code>updated_at</code></td><td>TIMESTAMPTZ</td><td>DerniÃ¨re modification</td><td>NOT NULL, auto-update</td></tr>
      </tbody>
    </table>
    <div class="px-5 py-3 bg-violet-50 border-t border-violet-200 text-xs">
      <p class="font-semibold text-violet-900 mb-2">ğŸ’¡ Exemples de mÃ©tadonnÃ©es par type :</p>
      <ul class="space-y-1 text-violet-800 list-disc pl-4">
        <li><strong>vehicle</strong> : <code>{"brand": "Renault", "model": "Clio", "year": 2020, "mileage": 45000, "vin": "VF1..."}</code></li>
        <li><strong>room</strong> : <code>{"number": "302", "floor": 3, "capacity": 2, "type": "double", "amenities": ["balcon", "vue mer"]}</code></li>
        <li><strong>patient</strong> : <code>{"birth_date": "1985-03-15", "blood_type": "A+", "allergies": ["pÃ©nicilline"], "ssn": "1..."}</code></li>
        <li><strong>legal_case</strong> : <code>{"case_number": "2024-123", "court": "TGI Paris", "type": "civil", "deadline": "2024-06-15"}</code></li>
        <li><strong>project</strong> : <code>{"surface": 500, "type": "jardin", "start_date": "2024-03-01", "location": {...}}</code></li>
      </ul>
    </div>
  </div>

  <!-- ServiceOrder (UNIVERSEL : remplace WorkOrder/OR) -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-violet-600 text-white flex items-center gap-2">
      <span class="font-mono text-sm font-bold">ServiceOrder</span>
      <span class="text-violet-200 text-xs">â€” Ordre de service universel (OR, housekeeping, traitement, chantier...)</span>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>PK</td><td>PK</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant</td><td>FK, NOT NULL, index</td></tr>
        <tr><td><code>order_id</code></td><td>UUID</td><td>Devis/commande source</td><td>FK â†’ Order.id, NULLABLE</td></tr>
        <tr><td><code>entity_id</code></td><td>UUID</td><td>EntitÃ© mÃ©tier concernÃ©e</td><td>FK â†’ Entity.id, NOT NULL, index</td></tr>
        <tr><td><code>contact_id</code></td><td>UUID</td><td>Client concernÃ©</td><td>FK â†’ Contact.id, NOT NULL</td></tr>
        <tr><td><code>order_type</code></td><td>ENUM</td><td>Type d'ordre</td><td>NOT NULL, VALUES: repair, cleaning, meal, treatment, legal_work, landscaping, appointment</td></tr>
        <tr><td><code>status</code></td><td>ENUM</td><td>Statut</td><td>NOT NULL, VALUES: draft, scheduled, in_progress, completed, billed, cancelled, DEFAULT 'draft'</td></tr>
        <tr><td><code>assigned_user_id</code></td><td>UUID</td><td>Collaborateur assignÃ©</td><td>FK â†’ User.id, NULLABLE</td></tr>
        <tr><td><code>scheduled_start</code></td><td>TIMESTAMPTZ</td><td>DÃ©but planifiÃ©</td><td>NULLABLE</td></tr>
        <tr><td><code>scheduled_end</code></td><td>TIMESTAMPTZ</td><td>Fin planifiÃ©e</td><td>NULLABLE</td></tr>
        <tr><td><code>actual_start</code></td><td>TIMESTAMPTZ</td><td>DÃ©but rÃ©el</td><td>NULLABLE</td></tr>
        <tr><td><code>actual_end</code></td><td>TIMESTAMPTZ</td><td>Fin rÃ©elle</td><td>NULLABLE</td></tr>
        <tr><td><code>notes</code></td><td>TEXT</td><td>Notes internes</td><td>NULLABLE</td></tr>
        <tr><td><code>metadata</code></td><td>JSONB</td><td>DonnÃ©es mÃ©tier spÃ©cifiques</td><td>NOT NULL, DEFAULT '{}'</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>CrÃ©ation</td><td>NOT NULL</td></tr>
        <tr><td><code>updated_at</code></td><td>TIMESTAMPTZ</td><td>MAJ</td><td>NOT NULL, auto-update</td></tr>
      </tbody>
    </table>
  </div>

  <!-- ResourceSchedule (UNIVERSEL : planning ressources) -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-violet-500 text-white flex items-center gap-2">
      <span class="font-mono text-sm font-bold">ResourceSchedule</span>
      <span class="text-violet-100 text-xs">â€” Planning ressources mÃ©tier (mÃ©caniciens, chambres, stylistes, praticiens...)</span>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>PK</td><td>PK</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant</td><td>FK, NOT NULL, index</td></tr>
        <tr><td><code>resource_type</code></td><td>ENUM</td><td>Type de ressource</td><td>NOT NULL, VALUES: mechanic, room, stylist, doctor, equipment, team, table</td></tr>
        <tr><td><code>resource_id</code></td><td>UUID</td><td>ID ressource (User ou Entity)</td><td>NOT NULL, index</td></tr>
        <tr><td><code>service_order_id</code></td><td>UUID</td><td>Ordre de service liÃ©</td><td>FK â†’ ServiceOrder.id, NULLABLE</td></tr>
        <tr><td><code>slot_start</code></td><td>TIMESTAMPTZ</td><td>DÃ©but crÃ©neau</td><td>NOT NULL, index</td></tr>
        <tr><td><code>slot_end</code></td><td>TIMESTAMPTZ</td><td>Fin crÃ©neau</td><td>NOT NULL, index</td></tr>
        <tr><td><code>status</code></td><td>ENUM</td><td>Statut slot</td><td>NOT NULL, VALUES: available, booked, in_progress, completed, cancelled, DEFAULT 'booked'</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>CrÃ©ation</td><td>NOT NULL</td></tr>
      </tbody>
    </table>
    <div class="px-5 py-3 bg-violet-50 border-t border-violet-200 text-xs">
      <p class="font-semibold text-violet-900 mb-1">ğŸ” Index de performance :</p>
      <p class="text-violet-700"><code>CREATE INDEX idx_schedule_slots ON ResourceSchedule (tenant_id, resource_id, slot_start, slot_end);</code></p>
      <p class="text-violet-700 mt-1"><code>CREATE INDEX idx_schedule_conflicts ON ResourceSchedule (resource_id, slot_start, slot_end) WHERE status NOT IN ('cancelled');</code></p>
    </div>
  </div>

  <!-- InventoryItem (UNIVERSEL : remplace Product pour le stock) -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-violet-400 text-white flex items-center gap-2">
      <span class="font-mono text-sm font-bold">InventoryItem</span>
      <span class="text-violet-50 text-xs">â€” Gestion inventaire universel (piÃ¨ces, denrÃ©es, produits, matÃ©riel...)</span>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>PK</td><td>PK</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant</td><td>FK, NOT NULL, index</td></tr>
        <tr><td><code>item_type</code></td><td>ENUM</td><td>Type d'item</td><td>NOT NULL, VALUES: spare_part, food, beverage, cosmetic, hair_product, medical_supply, material</td></tr>
        <tr><td><code>name</code></td><td>VARCHAR(255)</td><td>Nom de l'item</td><td>NOT NULL</td></tr>
        <tr><td><code>reference</code></td><td>VARCHAR(100)</td><td>RÃ©fÃ©rence fabricant/interne</td><td>index</td></tr>
        <tr><td><code>quantity</code></td><td>DECIMAL(10,2)</td><td>QuantitÃ© en stock</td><td>NOT NULL, DEFAULT 0</td></tr>
        <tr><td><code>unit</code></td><td>VARCHAR(20)</td><td>UnitÃ© (pcs, kg, L, box...)</td><td>NOT NULL, DEFAULT 'pcs'</td></tr>
        <tr><td><code>min_threshold</code></td><td>DECIMAL(10,2)</td><td>Seuil alerte rupture</td><td>NULLABLE</td></tr>
        <tr><td><code>purchase_price</code></td><td>DECIMAL(10,2)</td><td>Prix achat HT</td><td>NULLABLE</td></tr>
        <tr><td><code>sell_price</code></td><td>DECIMAL(10,2)</td><td>Prix vente HT</td><td>NULLABLE</td></tr>
        <tr><td><code>external_ref</code></td><td>VARCHAR(100)</td><td>RÃ©fÃ©rence fournisseur externe</td><td>NULLABLE, index</td></tr>
        <tr><td><code>metadata</code></td><td>JSONB</td><td>DonnÃ©es mÃ©tier (expiration, allergÃ¨nes, fabricant...)</td><td>DEFAULT '{}'</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>CrÃ©ation</td><td>NOT NULL</td></tr>
        <tr><td><code>updated_at</code></td><td>TIMESTAMPTZ</td><td>MAJ</td><td>NOT NULL, auto-update</td></tr>
      </tbody>
    </table>
    <div class="px-5 py-3 bg-violet-50 border-t border-violet-200 text-xs">
      <p class="font-semibold text-violet-900 mb-1">âš ï¸ Note importante :</p>
      <p class="text-violet-700">Cette table est optionnelle et n'est utilisÃ©e que par les mÃ©tiers avec stock physique (garage, restaurant, salon, dentiste). Les mÃ©tiers sans inventaire (avocat, consultant, mÃ©decin gÃ©nÃ©raliste) ne l'utilisent pas.</p>
    </div>
  </div>

  <!-- AutomatedReminder (UNIVERSEL : rappels mÃ©tiers) -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-amber-600 text-white flex items-center gap-2">
      <span class="font-mono text-sm font-bold">AutomatedReminder</span>
      <span class="text-amber-100 text-xs">â€” Rappels automatiques mÃ©tier (maintenance, RDV, deadline...)</span>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>PK</td><td>PK</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant</td><td>FK, NOT NULL, index</td></tr>
        <tr><td><code>contact_id</code></td><td>UUID</td><td>Contact destinataire</td><td>FK â†’ Contact.id, NOT NULL</td></tr>
        <tr><td><code>entity_id</code></td><td>UUID</td><td>EntitÃ© mÃ©tier liÃ©e</td><td>FK â†’ Entity.id, NULLABLE</td></tr>
        <tr><td><code>reminder_type</code></td><td>ENUM</td><td>Type de rappel</td><td>NOT NULL, VALUES: maintenance, booking, follow_up, deadline, renewal, appointment</td></tr>
        <tr><td><code>trigger_rule</code></td><td>JSONB</td><td>RÃ¨gle de dÃ©clenchement (frÃ©quence, dÃ©lai...)</td><td>NOT NULL</td></tr>
        <tr><td><code>next_send_date</code></td><td>TIMESTAMPTZ</td><td>Prochaine date d'envoi</td><td>NOT NULL, index</td></tr>
        <tr><td><code>last_sent_at</code></td><td>TIMESTAMPTZ</td><td>Dernier envoi</td><td>NULLABLE</td></tr>
        <tr><td><code>template</code></td><td>TEXT</td><td>Template message personnalisÃ©</td><td>NULLABLE</td></tr>
        <tr><td><code>is_active</code></td><td>BOOLEAN</td><td>Rappel actif ou dÃ©sactivÃ©</td><td>NOT NULL, DEFAULT true</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>CrÃ©ation</td><td>NOT NULL</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Review (UNIVERSEL : avis clients) -->
  <div class="card overflow-hidden mb-4">
    <div class="px-5 py-3 bg-emerald-600 text-white flex items-center gap-2">
      <span class="font-mono text-sm font-bold">Review</span>
      <span class="text-emerald-100 text-xs">â€” Avis clients multi-plateformes</span>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Contraintes</th></tr></thead>
      <tbody>
        <tr><td><code>id</code></td><td>UUID</td><td>PK</td><td>PK</td></tr>
        <tr><td><code>tenant_id</code></td><td>UUID</td><td>Tenant</td><td>FK, NOT NULL, index</td></tr>
        <tr><td><code>contact_id</code></td><td>UUID</td><td>Client auteur</td><td>FK â†’ Contact.id, NOT NULL</td></tr>
        <tr><td><code>service_order_id</code></td><td>UUID</td><td>Service concernÃ©</td><td>FK â†’ ServiceOrder.id, NULLABLE</td></tr>
        <tr><td><code>platform</code></td><td>ENUM</td><td>Plateforme d'avis</td><td>NOT NULL, VALUES: google, booking, tripadvisor, doctolib, trustpilot, yelp, internal</td></tr>
        <tr><td><code>rating</code></td><td>INT</td><td>Note (1-5)</td><td>NOT NULL, CHECK (rating BETWEEN 1 AND 5)</td></tr>
        <tr><td><code>comment</code></td><td>TEXT</td><td>Commentaire texte</td><td>NULLABLE</td></tr>
        <tr><td><code>status</code></td><td>ENUM</td><td>Statut</td><td>NOT NULL, VALUES: pending, published, replied, hidden, DEFAULT 'pending'</td></tr>
        <tr><td><code>request_sent_at</code></td><td>TIMESTAMPTZ</td><td>Date envoi demande</td><td>NULLABLE</td></tr>
        <tr><td><code>reviewed_at</code></td><td>TIMESTAMPTZ</td><td>Date avis client</td><td>NULLABLE</td></tr>
        <tr><td><code>external_url</code></td><td>TEXT</td><td>URL avis externe (si publiÃ©)</td><td>NULLABLE</td></tr>
        <tr><td><code>created_at</code></td><td>TIMESTAMPTZ</td><td>CrÃ©ation</td><td>NOT NULL</td></tr>
      </tbody>
    </table>
  </div>

  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     11 â€” NONâ€‘FUNCTIONAL REQUIREMENTS
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="nfr">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">11</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Exigences nonâ€‘fonctionnelles</h2>
  </div>

  <div class="grid lg:grid-cols-2 gap-6">

    <!-- Performance -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-brand-100 flex items-center justify-center text-xs">âš¡</span>
        Performance
      </h3>
      <table class="data-table w-full">
        <thead><tr><th>MÃ©trique</th><th>Cible</th></tr></thead>
        <tbody>
          <tr><td>Temps de rÃ©ponse API (P95)</td><td class="font-semibold text-surface-900">&lt; 300 ms</td></tr>
          <tr><td>recherche entitÃ© mÃ©tier (incluant appel TechAlliance)</td><td class="font-semibold text-surface-900">&lt; 2 s</td></tr>
          <tr><td>GÃ©nÃ©ration IA (description / message)</td><td class="font-semibold text-surface-900">&lt; 5 s (streaming)</td></tr>
          <tr><td>Chargement dashboard pro (First Contentful Paint)</td><td class="font-semibold text-surface-900">&lt; 1.5 s</td></tr>
          <tr><td>Taille bundle Flutter Web (gzipped)</td><td class="font-semibold text-surface-900">&lt; 2 MB</td></tr>
          <tr><td>VolumÃ©trie cible MVP</td><td class="font-semibold text-surface-900">1 000 tenants, 100k clients, 200k entitÃ©s mÃ©tiers</td></tr>
          <tr><td>RequÃªtes concurrentes supportÃ©es</td><td class="font-semibold text-surface-900">200 req/s</td></tr>
          <tr><td>RequÃªtes par tenant / jour</td><td class="font-semibold text-surface-900">10 000 max (configurable par plan)</td></tr>
        </tbody>
      </table>
    </div>

    <!-- SÃ©curitÃ© -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-emerald-100 flex items-center justify-center text-xs">ğŸ”’</span>
        SÃ©curitÃ©
      </h3>
      <table class="data-table w-full">
        <thead><tr><th>Exigence</th><th>ImplÃ©mentation</th></tr></thead>
        <tbody>
          <tr><td>Chiffrement en transit</td><td>TLS 1.3 obligatoire sur tous les endpoints</td></tr>
          <tr><td>Chiffrement au repos</td><td>AESâ€‘256 pour la DB et les backups</td></tr>
          <tr><td>Isolation multiâ€‘tenant</td><td>RLS PostgreSQL sur toutes les tables avec tenant_id</td></tr>
          <tr><td>MFA</td><td>TOTP optionnel, recommandÃ© pour les admins</td></tr>
          <tr><td>Rotation des clÃ©s API tierces</td><td>MÃ©canisme de rotation sans downtime, alerte expiration</td></tr>
          <tr><td>Logs d'audit</td><td>Immutables, rÃ©tention 12 mois minimum</td></tr>
          <tr><td>ClÃ©s API dans config_json</td><td>ChiffrÃ©es avec clÃ© dÃ©rivÃ©e par tenant (envelope encryption)</td></tr>
          <tr><td>Rate limiting</td><td>100 req/min par tenant (configurable par plan)</td></tr>
          <tr><td>DonnÃ©es carte bancaire</td><td>Jamais stockÃ©es cÃ´tÃ© Vision CRM (Stripe uniquement)</td></tr>
        </tbody>
      </table>
    </div>

    <!-- DisponibilitÃ© -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-cyan-100 flex items-center justify-center text-xs">ğŸŸ¢</span>
        DisponibilitÃ©
      </h3>
      <table class="data-table w-full">
        <thead><tr><th>SLA</th><th>Cible</th></tr></thead>
        <tbody>
          <tr><td>Uptime API (hors maintenance planifiÃ©e)</td><td class="font-semibold text-surface-900">99.5 % / mois</td></tr>
          <tr><td>FenÃªtre de maintenance</td><td>Dimanche 2hâ€“5h CET, notifiÃ©e 48h Ã  l'avance</td></tr>
          <tr><td>RTO (Recovery Time Objective)</td><td class="font-semibold text-surface-900">&lt; 4 h</td></tr>
          <tr><td>RPO (Recovery Point Objective)</td><td class="font-semibold text-surface-900">&lt; 1 h</td></tr>
          <tr><td>Backups DB</td><td>Automatiques toutes les 6 h, rÃ©tention 30 jours</td></tr>
          <tr><td>Monitoring</td><td>Health checks, alertes Slack/email sur erreurs 5xx, latence, DB</td></tr>
          <tr><td>DÃ©pendances tierces (TecDoc, etc.)</td><td>Fallback graceful : message utilisateur + retry automatique</td></tr>
        </tbody>
      </table>
    </div>

    <!-- ScalabilitÃ© -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-violet-100 flex items-center justify-center text-xs">ğŸ“ˆ</span>
        ScalabilitÃ©
      </h3>
      <table class="data-table w-full">
        <thead><tr><th>Dimension</th><th>StratÃ©gie</th></tr></thead>
        <tbody>
          <tr><td>Multiâ€‘tenant horizontal</td><td>tenant_id + RLS = mÃªme DB, mÃªmes services. Pas de sharding MVP.</td></tr>
          <tr><td>Backend stateless</td><td>Conteneurs sans Ã©tat â†’ scaling horizontal auto (K8s ou Fly.io).</td></tr>
          <tr><td>DB connections</td><td>Connection pooling via PgBouncer (ou Supabase pooler intÃ©grÃ©).</td></tr>
          <tr><td>UsageLog</td><td>Partitionnement mensuel. Archive > 12 mois vers stockage froid.</td></tr>
          <tr><td>Modules</td><td>Architecture plugin : ajouter un module ne nÃ©cessite pas de redÃ©ploiement core.</td></tr>
          <tr><td>CDN</td><td>Assets statiques (Flutter Web, images) servis via CDN (Cloudflare / Bunny).</td></tr>
          <tr><td>Cache</td><td>Redis pour cache lookup plaque (TTL 24h), sessions, rate limiting.</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- RGPD summary -->
  <div class="card p-6 mt-6 bg-surface-50 border-dashed">
    <h3 class="text-sm font-bold text-surface-900 mb-3 flex items-center gap-2">
      <span class="w-6 h-6 rounded bg-blue-100 flex items-center justify-center text-xs">ğŸ‡ªğŸ‡º</span>
      ConformitÃ© RGPD â€” rÃ©sumÃ©
    </h3>
    <div class="grid md:grid-cols-2 gap-4 text-xs text-surface-600">
      <div class="space-y-1.5">
        <p class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span><strong class="text-surface-800">Base lÃ©gale :</strong> contrat (fourniture du service) + consentement (communications marketing).</p>
        <p class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span><strong class="text-surface-800">Droit d'accÃ¨s :</strong> export des donnÃ©es personnelles via endpoint dÃ©diÃ© (<code>GET /me/export</code>).</p>
        <p class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span><strong class="text-surface-800">Droit Ã  l'oubli :</strong> suppression du compte et anonymisation des donnÃ©es liÃ©es.</p>
      </div>
      <div class="space-y-1.5">
        <p class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span><strong class="text-surface-800">Sousâ€‘traitants :</strong> Stripe (paiements), TechAlliance/TecDoc (donnÃ©es entitÃ©s mÃ©tiers), hÃ©bergeur cloud EU.</p>
        <p class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span><strong class="text-surface-800">DPA :</strong> contrat de traitement des donnÃ©es avec chaque sousâ€‘traitant.</p>
        <p class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span><strong class="text-surface-800">HÃ©bergement :</strong> donnÃ©es stockÃ©es en UE (France ou Allemagne).</p>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     12 â€” ROADMAP MVP
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="roadmap">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">12</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Roadmap MVP</h2>
  </div>
  <div class="card p-6 lg:p-8">
    <div class="space-y-8">
      <div class="relative flex gap-5">
        <div class="relative flex flex-col items-center"><div class="timeline-dot"></div><div class="timeline-line"></div></div>
        <div class="pb-8 flex-1">
          <div class="flex flex-wrap items-center gap-3 mb-2"><h4 class="font-bold text-surface-900">Phase 1 â€” Fondations</h4><span class="badge bg-brand-50 text-brand-700">Semaines 1â€“3</span></div>
          <ul class="space-y-1.5 text-sm text-surface-600">
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Setup projet Flutter (mobile + web) + backend modulaire + DB PostgreSQL multiâ€‘tenant.</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Auth multiâ€‘tenant (inscription, login, MFA, RBAC admin/pro/client).</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>SchÃ©ma DB complet (toutes les tables de la section 9.1).</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>CI/CD pipeline (lint, tests, deploy staging).</li>
          </ul>
        </div>
      </div>
      <div class="relative flex gap-5">
        <div class="relative flex flex-col items-center"><div class="timeline-dot"></div><div class="timeline-line"></div></div>
        <div class="pb-8 flex-1">
          <div class="flex flex-wrap items-center gap-3 mb-2"><h4 class="font-bold text-surface-900">Phase 2 â€” Modules core</h4><span class="badge bg-amber-50 text-amber-700">Semaines 4â€“6</span></div>
          <ul class="space-y-1.5 text-sm text-surface-600">
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-amber-400 flex-shrink-0"></span>Module <strong>tenant mÃ©tier</strong> : recherche entitÃ© mÃ©tier/ID mÃ©tier â†’ entitÃ© mÃ©tier â†’ piÃ¨ces (USâ€‘G01 Ã  G05).</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-amber-400 flex-shrink-0"></span>Module <strong>billing</strong> : forfaits, quotas, Stripe Connect (USâ€‘B01 Ã  B05).</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-amber-400 flex-shrink-0"></span>Framework intÃ©grations B2B : architecture plugin, stockage clÃ©s API chiffrÃ©es.</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-amber-400 flex-shrink-0"></span>Ã‰crans Flutter : recherche entitÃ© mÃ©tier, modules, billing (wireframes 2, 3, 4).</li>
          </ul>
        </div>
      </div>
      <div class="relative flex gap-5">
        <div class="relative flex flex-col items-center"><div class="timeline-dot" style="border-color: #10b981;"></div></div>
        <div class="flex-1">
          <div class="flex flex-wrap items-center gap-3 mb-2"><h4 class="font-bold text-surface-900">Phase 3 â€” IA + dÃ©ploiement</h4><span class="badge bg-emerald-50 text-emerald-700">Semaines 7â€“9</span></div>
          <ul class="space-y-1.5 text-sm text-surface-600">
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span>Module <strong>ai</strong> : gÃ©nÃ©ration descriptions, suggestions, analytics (USâ€‘A01 Ã  A05).</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span>Dashboard pro complet + dashboard client (wireframes 1, 5).</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span>Tests E2E + dÃ©ploiement MVP sur infra cloud EU.</li>
            <li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span>Monitoring, alerting, runbook opÃ©rationnel.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     13 â€” HÃ‰BERGEMENT & INFRASTRUCTURE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="infra">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">13</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">HÃ©bergement & infrastructure</h2>
  </div>

  <p class="text-sm text-surface-600 mb-5 leading-relaxed">
    Tous les services sont hÃ©bergÃ©s en <strong>Union EuropÃ©enne</strong> (France / Irlande) avec contrats DPA signÃ©s. Aucune donnÃ©e ne transite hors UE. ConformitÃ© RGPD vÃ©rifiable par localisation explicite de chaque service.
  </p>

  <div class="card overflow-hidden mb-6">
    <table class="data-table w-full">
      <thead><tr><th>Service</th><th>Provider</th><th>RÃ©gion</th><th>DÃ©tails</th></tr></thead>
      <tbody>
        <tr>
          <td><span class="badge bg-blue-50 text-blue-700">Frontend App</span></td>
          <td class="font-semibold text-surface-900">Vercel</td>
          <td><code>EU (Paris â€” cdg1)</code></td>
          <td>Flutter Web build servi via CDN mondial, HTTPS auto, TTFB &lt; 100 ms. Edge functions pour SSR si besoin.</td>
        </tr>
        <tr>
          <td><span class="badge bg-cyan-50 text-cyan-700">Frontend Vitrine</span></td>
          <td class="font-semibold text-surface-900">Vercel</td>
          <td><code>EU (Paris â€” cdg1)</code></td>
          <td>Next.js SSR/SSG. SEO optimisÃ©, formulaires marketing, landing pages. Projet Vercel sÃ©parÃ©.</td>
        </tr>
        <tr>
          <td><span class="badge bg-emerald-50 text-emerald-700">Base de donnÃ©es</span></td>
          <td class="font-semibold text-surface-900">Supabase PostgreSQL</td>
          <td><code>EU-West (Paris)</code></td>
          <td>RLS activÃ©, backups automatiques 7 j, PITR (Point-in-Time Recovery) 7 j, monitoring intÃ©grÃ©, connection pooling (PgBouncer).</td>
        </tr>
        <tr>
          <td><span class="badge bg-emerald-50 text-emerald-700">Backend API</span></td>
          <td class="font-semibold text-surface-900">Supabase Edge Functions</td>
          <td><code>EU-West (Paris)</code></td>
          <td>Serverless Deno/TypeScript, auto-scale, cold start &lt; 200 ms, logs natifs. Fallback : Node.js sur Fly.io EU si besoin de long-running tasks.</td>
        </tr>
        <tr>
          <td><span class="badge bg-amber-50 text-amber-700">Fichiers / Uploads</span></td>
          <td class="font-semibold text-surface-900">Supabase Storage</td>
          <td><code>EU-West (Paris)</code></td>
          <td>Compatible S3, chiffrÃ© at rest (AES-256), 5 GB inclus (plan Pro), policies RLS par tenant/bucket.</td>
        </tr>
        <tr>
          <td><span class="badge bg-violet-50 text-violet-700">Authentification</span></td>
          <td class="font-semibold text-surface-900">Supabase Auth</td>
          <td><code>EU-West (Paris)</code></td>
          <td>MFA (TOTP), OAuth (Google, Apple), magic links, JWT access (1 h) + refresh (24 h). Hooks pour multi-tenant.</td>
        </tr>
        <tr>
          <td><span class="badge bg-rose-50 text-rose-700">Paiements</span></td>
          <td class="font-semibold text-surface-900">Stripe</td>
          <td><code>EU (Ireland)</code></td>
          <td>SCA / PSD2 compliant, 3D Secure, Stripe Connect pour marketplace future, webhooks signÃ©s. Aucune donnÃ©e carte cÃ´tÃ© Vision CRM.</td>
        </tr>
        <tr>
          <td><span class="badge bg-amber-50 text-amber-700">Emails transactionnels</span></td>
          <td class="font-semibold text-surface-900">Resend</td>
          <td><code>EU</code></td>
          <td>DKIM / SPF / DMARC configurÃ©s, templates React Email, domaine <code>@visioncrm.fr</code>. Fallback : SendGrid EU.</td>
        </tr>
        <tr>
          <td><span class="badge bg-rose-50 text-rose-700">Monitoring & erreurs</span></td>
          <td class="font-semibold text-surface-900">Sentry</td>
          <td><code>EU (Frankfurt)</code></td>
          <td>Error tracking, performance monitoring, RUM (Real User Monitoring) frontend Flutter + backend. Alertes Slack / email.</td>
        </tr>
        <tr>
          <td><span class="badge bg-surface-100 text-surface-600">DNS / CDN</span></td>
          <td class="font-semibold text-surface-900">Cloudflare</td>
          <td><code>Global (EU primaire)</code></td>
          <td>DNS, WAF basique, DDoS protection, cache assets statiques. Gratuit pour l'essentiel.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Architecture diagram text -->
  <div class="card p-6 bg-surface-50 border-dashed">
    <h3 class="text-sm font-bold text-surface-900 mb-3">Architecture simplifiÃ©e</h3>
    <div class="font-mono text-xs text-surface-600 bg-white rounded-xl border border-surface-200 p-5 overflow-x-auto leading-relaxed whitespace-pre">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flutter Web/App â”‚    â”‚  Next.js Vitrine â”‚
â”‚   (Vercel CDN)   â”‚    â”‚   (Vercel CDN)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Cloudflare (DNS / WAF)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Supabase (EU-West â€” Paris)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Edge Fn   â”‚ â”‚PostgreSQLâ”‚ â”‚ Auth â”‚ â”‚
â”‚  â”‚ (API)     â”‚ â”‚ (RLS)    â”‚ â”‚ MFA  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚             â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Storage  â”‚ â”‚ Realtime â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Stripe  â”‚ â”‚  Resend  â”‚ â”‚  Sentry  â”‚
â”‚  (EU-IE) â”‚ â”‚  (EU)    â”‚ â”‚ (EU-DE)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     14 â€” PAGES LÃ‰GALES
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="legal">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">14</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Pages lÃ©gales</h2>
  </div>

  <p class="text-sm text-surface-600 mb-5 leading-relaxed">
    Pages statiques Next.js (site vitrine), accessibles depuis le footer. Obligatoires avant mise en production. RÃ©digÃ©es en franÃ§ais, conformes RGPD et droit franÃ§ais.
  </p>

  <div class="grid lg:grid-cols-2 gap-6 mb-6">

    <!-- CGU -->
    <div class="card p-6 border-t-4 border-t-brand-500">
      <div class="flex items-center gap-2 mb-3">
        <code class="font-mono text-xs bg-brand-50 text-brand-700 px-2 py-1 rounded">/cgu</code>
        <h3 class="font-bold text-surface-900 text-sm">Conditions GÃ©nÃ©rales d'Utilisation</h3>
      </div>
      <ul class="text-xs text-surface-600 space-y-1.5">
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Objet du service (SaaS CRM multi-tenant B2B)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Conditions d'inscription, rÃ´les (admin/pro/client), responsabilitÃ©s</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Tarification, forfaits, facturation usage, conditions de rÃ©siliation</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>PropriÃ©tÃ© intellectuelle, licence d'utilisation, donnÃ©es du tenant</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Limitations de responsabilitÃ©, SLA, force majeure</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Droit applicable : droit franÃ§ais, tribunal de Metz</li>
      </ul>
      <p class="text-[10px] text-surface-400 mt-3">Acceptation obligatoire au signup (checkbox + horodatage). Version datÃ©e et archivÃ©e.</p>
    </div>

    <!-- RGPD -->
    <div class="card p-6 border-t-4 border-t-accent-emerald">
      <div class="flex items-center gap-2 mb-3">
        <code class="font-mono text-xs bg-emerald-50 text-emerald-700 px-2 py-1 rounded">/rgpd</code>
        <h3 class="font-bold text-surface-900 text-sm">Politique de confidentialitÃ© & donnÃ©es</h3>
      </div>
      <ul class="text-xs text-surface-600 space-y-1.5">
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>Responsable :</strong> VisionProdâ€‘Labz, Yutz (57), France</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>DPO / Contact :</strong> <code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7713071837011e041e181914051a591105">[email&#160;protected]</a></code></li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>Base lÃ©gale :</strong> contrat (fourniture service) + consentement (marketing)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>DonnÃ©es collectÃ©es :</strong> identitÃ©, contact, entitÃ©s mÃ©tiers, usage, facturation</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>Sous-traitants :</strong> Supabase (DB/Auth/Storage EU), Vercel (CDN EU), Stripe EU (paiements), Resend (emails EU), Sentry (monitoring EU)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>Droits :</strong> accÃ¨s, rectification, portabilitÃ© (<code>GET /me/export</code>), oubli (<code>DELETE /me</code>), opposition</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>Conservation :</strong> donnÃ©es actives = durÃ©e du contrat, facturation = 5 ans (fiscal), logs d'audit = 13 mois, donnÃ©es supprimÃ©es = anonymisation sous 30 j</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-emerald flex-shrink-0"></span><strong>Transferts :</strong> aucun hors UE (tous les sous-traitants sont EU-hÃ©bergÃ©s)</li>
      </ul>
    </div>

    <!-- Mentions lÃ©gales -->
    <div class="card p-6 border-t-4 border-t-accent-amber">
      <div class="flex items-center gap-2 mb-3">
        <code class="font-mono text-xs bg-amber-50 text-amber-700 px-2 py-1 rounded">/mentions</code>
        <h3 class="font-bold text-surface-900 text-sm">Mentions lÃ©gales</h3>
      </div>
      <ul class="text-xs text-surface-600 space-y-1.5">
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span><strong>Ã‰diteur :</strong> VisionProdâ€‘Labz â€” Yutz (57110), France</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span><strong>Directeur de publication :</strong> [Nom gÃ©rant]</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span><strong>HÃ©bergeur :</strong> Vercel Inc. (site vitrine), Supabase Inc. (donnÃ©es, EU-West Paris)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span><strong>Contact :</strong> <code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c2a1adacb6a3a1b682b4abb1abadaca1b0afeca4b0">[email&#160;protected]</a></code></li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span><strong>SIRET :</strong> [Ã€ complÃ©ter]</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span><strong>TVA intracommunautaire :</strong> [Ã€ complÃ©ter]</li>
      </ul>
    </div>

    <!-- Cookies -->
    <div class="card p-6 border-t-4 border-t-accent-violet">
      <div class="flex items-center gap-2 mb-3">
        <code class="font-mono text-xs bg-violet-50 text-violet-700 px-2 py-1 rounded">/cookies</code>
        <h3 class="font-bold text-surface-900 text-sm">Politique cookies & consentement</h3>
      </div>
      <ul class="text-xs text-surface-600 space-y-1.5">
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span><strong>Cookies strictement nÃ©cessaires :</strong> session auth (JWT), prÃ©fÃ©rences UI, tenant context â€” pas de consentement requis</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span><strong>Cookies analytics :</strong> PostHog (EU) â€” opt-in requis via banniÃ¨re</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span><strong>Cookies marketing :</strong> aucun au MVP. GA4 anonymisÃ© si ajoutÃ© (opt-in)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span><strong>BanniÃ¨re consentement :</strong> implÃ©mentÃ©e via <code>cookie-consent</code> (lib open-source) ou Axeptio</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span><strong>DurÃ©e :</strong> cookies session = fermeture navigateur, persistants = 13 mois max</li>
      </ul>
    </div>
  </div>

  <!-- DPA table -->
  <div class="card overflow-hidden">
    <div class="px-6 py-3 border-b border-surface-200">
      <h3 class="text-sm font-bold text-surface-900">Contrats DPA (Data Processing Agreement)</h3>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Sous-traitant</th><th>DonnÃ©es traitÃ©es</th><th>Localisation</th><th>DPA</th></tr></thead>
      <tbody>
        <tr><td>Supabase</td><td>Toutes les donnÃ©es mÃ©tier (DB, auth, storage)</td><td>EU-West (Paris)</td><td class="text-accent-emerald font-semibold">âœ… Inclus GDPR EU</td></tr>
        <tr><td>Vercel</td><td>RequÃªtes HTTP, logs CDN (pas de PII stockÃ©)</td><td>EU (Paris)</td><td class="text-accent-emerald font-semibold">âœ… DPA signable</td></tr>
        <tr><td>Stripe</td><td>DonnÃ©es de facturation, transactions</td><td>EU (Ireland)</td><td class="text-accent-emerald font-semibold">âœ… SCA/PSD2</td></tr>
        <tr><td>Resend</td><td>Emails transactionnels (adresses email)</td><td>EU</td><td class="text-accent-emerald font-semibold">âœ… DPA signable</td></tr>
        <tr><td>Sentry</td><td>Erreurs, traces perf (anonymisation PII configurable)</td><td>EU (Frankfurt)</td><td class="text-accent-emerald font-semibold">âœ… GDPR compliant</td></tr>
        <tr><td>Cloudflare</td><td>DNS, cache (pas de PII stockÃ©)</td><td>Global</td><td class="text-accent-emerald font-semibold">âœ… DPA standard</td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     15 â€” MÃ‰TRIQUES SUCCÃˆS & KPIs
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="kpis">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">15</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">MÃ©triques succÃ¨s & KPIs</h2>
  </div>

  <div class="card overflow-hidden mb-6">
    <div class="px-6 py-3 border-b border-surface-200">
      <h3 class="text-sm font-bold text-surface-900">KPIs business â€” objectifs mesurables</h3>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>MÃ©trique</th><th>Objectif MVP (S9)</th><th>Objectif 6 mois</th><th>Source de mesure</th></tr></thead>
      <tbody>
        <tr>
          <td class="font-semibold text-surface-900">Taux conversion essai â†’ payant</td>
          <td><span class="badge bg-brand-50 text-brand-700">15 %</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">25 %</span></td>
          <td>Stripe Subscriptions + tenant.plan</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">MRR (Monthly Recurring Revenue)</td>
          <td><span class="badge bg-brand-50 text-brand-700">2 000 â‚¬</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">20 000 â‚¬</span></td>
          <td>Stripe Dashboard / API</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">Churn mensuel</td>
          <td><span class="badge bg-amber-50 text-amber-700">&lt; 5 %</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">&lt; 3 %</span></td>
          <td>Stripe + tenant.plan history</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">Temps recherche entitÃ© mÃ©tier (P95)</td>
          <td><span class="badge bg-brand-50 text-brand-700">&lt; 3 s</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">&lt; 1.5 s</span></td>
          <td>UsageLog + Sentry perf</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">Satisfaction NPS</td>
          <td><span class="badge bg-brand-50 text-brand-700">&gt; 7/10</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">&gt; 8/10</span></td>
          <td>Survey post-login (micro-widget)</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">Adoption module tenant mÃ©tier</td>
          <td><span class="badge bg-brand-50 text-brand-700">80 % tenants</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">90 % tenants</span></td>
          <td>TenantModule (is_enabled=true)</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">Adoption module IA</td>
          <td><span class="badge bg-brand-50 text-brand-700">40 % tenants</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">65 % tenants</span></td>
          <td>TenantModule + UsageLog (ai.*)</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">Devis gÃ©nÃ©rÃ©s / tenant / mois</td>
          <td><span class="badge bg-brand-50 text-brand-700">&gt; 10</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">&gt; 30</span></td>
          <td>Order (type=devis) count</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900">Taux acceptation devis</td>
          <td><span class="badge bg-brand-50 text-brand-700">&gt; 50 %</span></td>
          <td><span class="badge bg-accent-emerald/10 text-accent-emerald">&gt; 65 %</span></td>
          <td>Order (status=accepted / total sent)</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Leading indicators -->
  <div class="card p-6 bg-surface-50 border-dashed">
    <h3 class="text-sm font-bold text-surface-900 mb-3">Indicateurs avancÃ©s (leading indicators)</h3>
    <div class="grid md:grid-cols-3 gap-4 text-xs text-surface-600">
      <div>
        <p class="font-semibold text-surface-800 mb-1">Activation</p>
        <p>% de tenants qui effectuent une recherche entitÃ© mÃ©tier dans les 24 h aprÃ¨s inscription. Cible : &gt; 60 %.</p>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-1">Engagement</p>
        <p>DAU/MAU ratio (Daily/Monthly Active Users). Cible MVP : &gt; 30 %. Signe d'un produit Â« sticky Â».</p>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-1">Expansion revenue</p>
        <p>% du MRR provenant d'achats de crÃ©dits IA supplÃ©mentaires (usage-based). Cible 6 mois : &gt; 15 % du MRR.</p>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     16 â€” CAS D'ERREUR & RÃ‰SILIENCE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="resilience">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">16</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Cas d'erreur & rÃ©silience</h2>
  </div>

  <p class="text-sm text-surface-600 mb-5 leading-relaxed">
    Chaque scÃ©nario d'erreur prÃ©visible est traitÃ© avec un fallback explicite. L'objectif : <strong>aucun Ã©cran blanc, aucun crash silencieux</strong>. L'utilisateur voit toujours un message clair et une action possible.
  </p>

  <div class="space-y-4">

    <!-- Error 1 -->
    <div class="card p-5 border-l-4 border-l-accent-rose">
      <div class="flex items-start gap-4">
        <div class="w-10 h-10 rounded-lg bg-rose-50 flex items-center justify-center flex-shrink-0 text-lg">ğŸ”Œ</div>
        <div class="flex-1">
          <h4 class="font-bold text-surface-900 text-sm mb-1">API TechAlliance / TecDoc indisponible</h4>
          <div class="grid md:grid-cols-3 gap-3 text-xs text-surface-600">
            <div><p class="font-semibold text-surface-700 mb-0.5">DÃ©tection</p><p>Timeout &gt; 5 s ou HTTP 5xx sur l'appel fournisseur.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Fallback</p><p>Servir le cache local (TTL 24 h) si le entitÃ© mÃ©tier a dÃ©jÃ  Ã©tÃ© recherchÃ©. Sinon, afficher banniÃ¨re warning + proposer saisie manuelle du entitÃ© mÃ©tier.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Alerte</p><p>Notification Sentry (severity: warning). Si &gt; 5 min d'indisponibilitÃ© â†’ alerte Slack super_admin.</p></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error 2 -->
    <div class="card p-5 border-l-4 border-l-accent-amber">
      <div class="flex items-start gap-4">
        <div class="w-10 h-10 rounded-lg bg-amber-50 flex items-center justify-center flex-shrink-0 text-lg">âš¡</div>
        <div class="flex-1">
          <h4 class="font-bold text-surface-900 text-sm mb-1">Quota IA dÃ©passÃ©</h4>
          <div class="grid md:grid-cols-3 gap-3 text-xs text-surface-600">
            <div><p class="font-semibold text-surface-700 mb-0.5">DÃ©tection</p><p>Compteur <code>current_usage.ai_credits_used â‰¥ monthly_credits</code>.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Fallback</p><p>Mode dÃ©gradÃ© : prompts courts uniquement (max 500 tokens output). BanniÃ¨re persistante Â« CrÃ©dits IA Ã©puisÃ©s â€” Acheter des crÃ©dits ou upgrader Â». Le reste du CRM fonctionne normalement.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Alerte</p><p>Email automatique au admin du tenant Ã  80 %, 95 % et 100 % du quota.</p></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error 3 -->
    <div class="card p-5 border-l-4 border-l-accent-rose">
      <div class="flex items-start gap-4">
        <div class="w-10 h-10 rounded-lg bg-rose-50 flex items-center justify-center flex-shrink-0 text-lg">ğŸ’³</div>
        <div class="flex-1">
          <h4 class="font-bold text-surface-900 text-sm mb-1">Ã‰chec de paiement Stripe</h4>
          <div class="grid md:grid-cols-3 gap-3 text-xs text-surface-600">
            <div><p class="font-semibold text-surface-700 mb-0.5">DÃ©tection</p><p>Webhook Stripe <code>invoice.payment_failed</code>.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Fallback</p><p>Retry automatique : J+1, J+3, J+7 (Stripe Smart Retries). Email de relance Ã  chaque Ã©chec avec lien mise Ã  jour carte (Stripe Portal). AprÃ¨s 3 Ã©checs : banniÃ¨re Â« Paiement en attente Â» dans l'app + fonctionnalitÃ©s limitÃ©es (lecture seule aprÃ¨s J+14).</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Alerte</p><p>Notification super_admin si le tenant a un MRR &gt; 100 â‚¬/mois (client Ã  fort revenu).</p></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error 4 -->
    <div class="card p-5 border-l-4 border-l-accent-amber">
      <div class="flex items-start gap-4">
        <div class="w-10 h-10 rounded-lg bg-amber-50 flex items-center justify-center flex-shrink-0 text-lg">ğŸ”</div>
        <div class="flex-1">
          <h4 class="font-bold text-surface-900 text-sm mb-1">Plaque / ID mÃ©tier non trouvÃ©</h4>
          <div class="grid md:grid-cols-3 gap-3 text-xs text-surface-600">
            <div><p class="font-semibold text-surface-700 mb-0.5">DÃ©tection</p><p>RÃ©ponse API 404 ou rÃ©sultat vide aprÃ¨s lookup.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Fallback</p><p>Message Â« entitÃ© mÃ©tier non trouvÃ© dans la base Â». Proposer : (1) vÃ©rifier la saisie, (2) rechercher par ID mÃ©tier si plaque, (3) Â« Ajouter manuellement Â» â†’ formulaire simplifiÃ© (marque, modÃ¨le, annÃ©e).</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Alerte</p><p>Log dans UsageLog (action: <code>plate_lookup_miss</code>) pour analyser les patterns (plaques Ã©trangÃ¨res, anciennes immatriculationsâ€¦).</p></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error 5 -->
    <div class="card p-5 border-l-4 border-l-accent-violet">
      <div class="flex items-start gap-4">
        <div class="w-10 h-10 rounded-lg bg-violet-50 flex items-center justify-center flex-shrink-0 text-lg">ğŸš«</div>
        <div class="flex-1">
          <h4 class="font-bold text-surface-900 text-sm mb-1">Tenant suspendu (impayÃ© / abus)</h4>
          <div class="grid md:grid-cols-3 gap-3 text-xs text-surface-600">
            <div><p class="font-semibold text-surface-700 mb-0.5">DÃ©tection</p><p>Flag <code>tenant.status = 'suspended'</code> activÃ© par super_admin ou automatiquement aprÃ¨s 3 Ã©checs paiement consÃ©cutifs.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Fallback</p><p>Tous les users du tenant voient une vue <strong>read-only</strong> : ils peuvent consulter les donnÃ©es mais ne peuvent ni crÃ©er, ni modifier, ni utiliser les modules. BanniÃ¨re rouge Â« Votre compte est suspendu Â» avec CTA Â« RÃ©gler ma facture Â» â†’ Stripe Portal.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Alerte</p><p>Email auto au admin du tenant. Notification super_admin pour suivi.</p></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error 6 -->
    <div class="card p-5 border-l-4 border-l-surface-300">
      <div class="flex items-start gap-4">
        <div class="w-10 h-10 rounded-lg bg-surface-100 flex items-center justify-center flex-shrink-0 text-lg">ğŸŒ</div>
        <div class="flex-1">
          <h4 class="font-bold text-surface-900 text-sm mb-1">Supabase / infrastructure indisponible</h4>
          <div class="grid md:grid-cols-3 gap-3 text-xs text-surface-600">
            <div><p class="font-semibold text-surface-700 mb-0.5">DÃ©tection</p><p>Health check Ã©choue (endpoint <code>/health</code> â†’ 503). Sentry alerte automatique.</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Fallback</p><p>Page de maintenance statique servie par Vercel (pas de dÃ©pendance Supabase). Message Â« Maintenance en cours, nous revenons dans quelques minutes Â». Status page publique (<code>status.visioncrm.fr</code>).</p></div>
            <div><p class="font-semibold text-surface-700 mb-0.5">Alerte</p><p>Alerte immÃ©diate Slack + SMS super_admin. Runbook : vÃ©rifier Supabase status, basculer sur backup si &gt; 15 min.</p></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     17 â€” ONBOARDING FLOWS
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="onboarding">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">17</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Onboarding flows</h2>
  </div>

  <div class="grid lg:grid-cols-2 gap-6">

    <!-- Onboarding Pro -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-2 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-brand-100 flex items-center justify-center text-xs">ğŸ‘¨â€ğŸ”§</span>
        Onboarding Pro (tenant mÃ©tier) â€” 5 Ã©tapes
      </h3>
      <p class="text-xs text-surface-400 mb-4">Objectif : premier devis crÃ©Ã© en &lt; 10 min. Taux de complÃ©tion cible : &gt; 70 %.</p>

      <div class="space-y-3">
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-brand-600 text-white text-xs font-bold flex items-center justify-center flex-shrink-0">1</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">Inscription</p>
            <p class="text-xs text-surface-500">Email + mot de passe â†’ vÃ©rification email (lien). Acceptation CGU + RGPD (checkbox horodatÃ©e). Page : formulaire Ã©purÃ©, aucune distraction.</p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-brand-600 text-white text-xs font-bold flex items-center justify-center flex-shrink-0">2</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">CrÃ©ation du tenant</p>
            <p class="text-xs text-surface-500">Nom du tenant mÃ©tier, SIRET (optionnel, prÃ©-rempli si API Sirene), upload logo, adresse postale. Slug auto-gÃ©nÃ©rÃ© (<code>mon-tenant mÃ©tier.visioncrm.fr</code>).</p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-brand-600 text-white text-xs font-bold flex items-center justify-center flex-shrink-0">3</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">Choix du plan</p>
            <p class="text-xs text-surface-500">Free trial 14 jours (toutes fonctionnalitÃ©s). Choix du plan : Starter / Pro / Enterprise. Paiement Stripe (SCA / 3D Secure). Pas de CB nÃ©cessaire pour le trial.</p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-brand-600 text-white text-xs font-bold flex items-center justify-center flex-shrink-0">4</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">Activation modules + clÃ©s API</p>
            <p class="text-xs text-surface-500">Toggle tenant mÃ©tier + billing (activÃ©s par dÃ©faut). Si le pro a un compte TechAlliance / HaynesPro â†’ coller les clÃ©s API. Bouton Â« Tester la connexion Â» â†’ feedback vert/rouge.</p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-accent-emerald text-white text-xs font-bold flex items-center justify-center flex-shrink-0">5</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">Premier usage guidÃ©</p>
            <p class="text-xs text-surface-500">recherche entitÃ© mÃ©tier test (plaque de dÃ©mo prÃ©-remplie). RÃ©sultat â†’ Â« Bravo, votre tenant mÃ©tier est prÃªt ! Â». Checklist post-onboarding : ajouter premier client, crÃ©er premier devis, inviter un collaborateur.</p>
          </div>
        </div>
      </div>

      <!-- Checklist -->
      <div class="mt-4 bg-surface-50 rounded-xl p-4">
        <p class="text-xs font-semibold text-surface-800 mb-2">Checklist post-onboarding (dashboard)</p>
        <div class="space-y-1.5 text-xs text-surface-600">
          <p class="flex items-center gap-2"><span class="w-4 h-4 rounded border border-surface-300 flex items-center justify-center text-[10px]">â˜</span> Ajouter votre premier client</p>
          <p class="flex items-center gap-2"><span class="w-4 h-4 rounded border border-surface-300 flex items-center justify-center text-[10px]">â˜</span> CrÃ©er votre premier devis</p>
          <p class="flex items-center gap-2"><span class="w-4 h-4 rounded border border-surface-300 flex items-center justify-center text-[10px]">â˜</span> Inviter un collaborateur</p>
          <p class="flex items-center gap-2"><span class="w-4 h-4 rounded border border-surface-300 flex items-center justify-center text-[10px]">â˜</span> Configurer vos clÃ©s API fournisseur</p>
          <p class="flex items-center gap-2"><span class="w-4 h-4 rounded border border-surface-300 flex items-center justify-center text-[10px]">â˜</span> Essayer la gÃ©nÃ©ration IA</p>
        </div>
      </div>
    </div>

    <!-- Onboarding Client -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-2 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-emerald-100 flex items-center justify-center text-xs">ğŸš—</span>
        Onboarding Client final â€” 3 Ã©tapes
      </h3>
      <p class="text-xs text-surface-400 mb-4">Objectif : consulter son devis en &lt; 30 s. ZÃ©ro friction (pas de mot de passe au premier accÃ¨s).</p>

      <div class="space-y-3">
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-accent-emerald text-white text-xs font-bold flex items-center justify-center flex-shrink-0">1</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">Lien devis par email</p>
            <p class="text-xs text-surface-500">Le client reÃ§oit un email du tenant mÃ©tier avec un lien sÃ©curisÃ© (token unique, expiration 30 j). Clic â†’ connexion automatique (magic link). Pas besoin de mot de passe au premier accÃ¨s.</p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-accent-emerald text-white text-xs font-bold flex items-center justify-center flex-shrink-0">2</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">Dashboard client</p>
            <p class="text-xs text-surface-500">Vue simplifiÃ©e : le devis est affichÃ© directement. Actions : Â« Accepter Â» (signature simple) ou Â« Refuser Â» (motif optionnel). AccÃ¨s aux onglets : Mes entitÃ©s mÃ©tiers, Historique, Notifications.</p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <div class="w-8 h-8 rounded-full bg-accent-emerald text-white text-xs font-bold flex items-center justify-center flex-shrink-0">3</div>
          <div>
            <p class="text-sm font-semibold text-surface-900">Notifications push & rappels</p>
            <p class="text-xs text-surface-500">Opt-in notifications push (mobile) et email. Rappels automatiques : contrÃ´le technique, vidange, entretien pÃ©riodique. Le client peut gÃ©rer ses prÃ©fÃ©rences de notification.</p>
          </div>
        </div>
      </div>

      <!-- Trial conversion flow -->
      <div class="mt-6 pt-5 border-t border-surface-200">
        <h3 class="text-sm font-bold text-surface-900 mb-2 flex items-center gap-2">
          <span class="w-6 h-6 rounded bg-amber-100 flex items-center justify-center text-xs">â°</span>
          Flow conversion trial â†’ payant
        </h3>
        <p class="text-xs text-surface-400 mb-3">SÃ©quence automatique pendant les 14 jours de trial.</p>
        <div class="space-y-2 text-xs text-surface-600">
          <div class="flex items-center gap-3">
            <span class="badge bg-surface-100 text-surface-600 w-12 text-center">J+0</span>
            <p>Email bienvenue + lien accÃ¨s + guide dÃ©marrage rapide (PDF).</p>
          </div>
          <div class="flex items-center gap-3">
            <span class="badge bg-surface-100 text-surface-600 w-12 text-center">J+3</span>
            <p>Si onboarding incomplet â†’ email rappel avec les Ã©tapes restantes.</p>
          </div>
          <div class="flex items-center gap-3">
            <span class="badge bg-surface-100 text-surface-600 w-12 text-center">J+7</span>
            <p>Email Â« Votre essai est Ã  mi-parcours Â» + highlight des fonctionnalitÃ©s pas encore testÃ©es.</p>
          </div>
          <div class="flex items-center gap-3">
            <span class="badge bg-amber-50 text-amber-700 w-12 text-center">J+10</span>
            <p>Email Â« Plus que 4 jours Â» + comparatif plans + CTA Â« Choisir mon plan Â».</p>
          </div>
          <div class="flex items-center gap-3">
            <span class="badge bg-amber-50 text-amber-700 w-12 text-center">J+13</span>
            <p>Email Â« Dernier jour demain Â» + offre early adopter (-20 % 3 mois) si conversion immÃ©diate.</p>
          </div>
          <div class="flex items-center gap-3">
            <span class="badge bg-rose-50 text-rose-700 w-12 text-center">J+14</span>
            <p>Trial expirÃ© â†’ plan dÃ©gradÃ© (read-only). BanniÃ¨re dans l'app Â« Passez Ã  un plan payant pour continuer Â».</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     18 â€” ANALYTICS & TRACKING
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="analytics">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">18</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Analytics & tracking</h2>
  </div>

  <p class="text-sm text-surface-600 mb-5 leading-relaxed">
    Approche <strong>privacy-first</strong> : tous les outils sont EU-hÃ©bergÃ©s ou auto-hÃ©bergeable, aucun tracking sans consentement opt-in RGPD pour les cookies non essentiels. Les Ã©vÃ©nements mÃ©tier (UsageLog) sont la source de vÃ©ritÃ© interne, les outils tiers sont complÃ©mentaires.
  </p>

  <!-- Tools -->
  <div class="grid md:grid-cols-3 gap-4 mb-6">

    <div class="card p-5 border-t-4 border-t-brand-500">
      <h3 class="font-bold text-surface-900 text-sm mb-2">PostHog EU</h3>
      <span class="badge bg-brand-50 text-brand-700 mb-2">Product analytics</span>
      <ul class="text-xs text-surface-500 space-y-1">
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Self-hostable (Docker) ou cloud EU</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Funnels, retention, feature flags (complÃ¨te l'internal)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>Session replay (opt-in, PII masquÃ©)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-brand-400 flex-shrink-0"></span>SDK Flutter + Web disponibles</li>
      </ul>
      <p class="text-[10px] text-surface-400 mt-2">Consentement : opt-in via banniÃ¨re cookies.</p>
    </div>

    <div class="card p-5 border-t-4 border-t-accent-amber">
      <h3 class="font-bold text-surface-900 text-sm mb-2">Google Analytics 4</h3>
      <span class="badge bg-amber-50 text-amber-700 mb-2">Marketing site only</span>
      <ul class="text-xs text-surface-500 space-y-1">
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span>Uniquement sur le site vitrine Next.js</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span>IP anonymisÃ©, pas de PII</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span>Conversion tracking (signup, plan choisi)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-amber flex-shrink-0"></span>Pas installÃ© dans l'app CRM Flutter</li>
      </ul>
      <p class="text-[10px] text-surface-400 mt-2">Consentement : opt-in via banniÃ¨re cookies. Alternative privacy : Plausible.io EU.</p>
    </div>

    <div class="card p-5 border-t-4 border-t-accent-violet">
      <h3 class="font-bold text-surface-900 text-sm mb-2">Sentry EU</h3>
      <span class="badge bg-violet-50 text-violet-700 mb-2">Error & perf monitoring</span>
      <ul class="text-xs text-surface-500 space-y-1">
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span>Error tracking (Flutter + Edge Functions)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span>Performance (Web Vitals, TTFB, API latency)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span>RUM (Real User Monitoring)</li>
        <li class="flex items-start gap-1.5"><span class="mt-0.5 w-1.5 h-1.5 rounded-full bg-accent-violet flex-shrink-0"></span>PII scrubbing activÃ© (emails, noms masquÃ©s dans les traces)</li>
      </ul>
      <p class="text-[10px] text-surface-400 mt-2">Pas de consentement requis (cookie strictement nÃ©cessaire pour la sÃ©curitÃ©).</p>
    </div>
  </div>

  <!-- Tracked events -->
  <div class="card overflow-hidden">
    <div class="px-6 py-3 border-b border-surface-200">
      <h3 class="text-sm font-bold text-surface-900">Ã‰vÃ©nements trackÃ©s (plan de taggage)</h3>
    </div>
    <table class="data-table w-full">
      <thead><tr><th>Ã‰vÃ©nement</th><th>Source</th><th>PropriÃ©tÃ©s</th><th>Outil</th></tr></thead>
      <tbody>
        <tr>
          <td class="font-semibold text-surface-900"><code>signup_completed</code></td>
          <td>Auth</td>
          <td>plan_chosen, referrer, utm_source</td>
          <td>PostHog + GA4</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>onboarding_step</code></td>
          <td>App</td>
          <td>step_number (1-5), step_name, completed (bool)</td>
          <td>PostHog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>plate_search</code></td>
          <td>Module tenant mÃ©tier</td>
          <td>nb_results, response_time_ms, cache_hit (bool)</td>
          <td>UsageLog + PostHog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>quote_created</code></td>
          <td>Module tenant mÃ©tier</td>
          <td>nb_lines, total_ttc, vehicle_id</td>
          <td>UsageLog + PostHog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>quote_accepted</code></td>
          <td>Client action</td>
          <td>order_id, total_ttc, time_to_accept_hours</td>
          <td>UsageLog + PostHog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>module_activated</code></td>
          <td>Admin action</td>
          <td>module_slug, plan_tier</td>
          <td>UsageLog + PostHog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>ai_generate</code></td>
          <td>Module AI</td>
          <td>type (description/message/analysis), tokens_in, tokens_out, credits_consumed</td>
          <td>UsageLog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>ai_satisfaction</code></td>
          <td>Module AI</td>
          <td>generation_id, rating (1-5), edited (bool)</td>
          <td>PostHog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>billing_upgrade</code></td>
          <td>Billing</td>
          <td>old_plan, new_plan, mrr_delta</td>
          <td>Stripe + PostHog</td>
        </tr>
        <tr>
          <td class="font-semibold text-surface-900"><code>trial_expired</code></td>
          <td>SystÃ¨me</td>
          <td>tenant_id, onboarding_completion (%), features_used[]</td>
          <td>UsageLog + PostHog</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Privacy notice -->
  <div class="card p-5 mt-5 bg-surface-50 border-dashed">
    <p class="text-xs text-surface-500 flex items-start gap-2">
      <span class="mt-0.5 w-5 h-5 rounded bg-emerald-100 flex items-center justify-center text-[10px] flex-shrink-0">ğŸ‡ªğŸ‡º</span>
      <span><strong class="text-surface-700">Principe privacy-first :</strong> les donnÃ©es UsageLog (internes, nÃ©cessaires au billing) sont la source de vÃ©ritÃ©. PostHog et GA4 sont optionnels et soumis au consentement. Aucun outil de tracking n'est chargÃ© avant acceptation des cookies. Le CRM fonctionne Ã  100 % sans aucun tracker externe activÃ©.</span>
    </p>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     19 â€” DESIGN SYSTEM
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="designsystem">
  <div class="flex items-center gap-3 mb-6">
    <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center"><span class="text-brand-600 font-mono text-sm font-bold">19</span></div>
    <h2 class="font-display text-3xl text-surface-900 italic">Design System</h2>
  </div>

  <p class="text-sm text-surface-600 mb-6 leading-relaxed">
    SystÃ¨me de design centralisÃ© pour Vision CRM. Tous les tokens visuels (couleurs, typographie, espacements, radius) sont dÃ©finis ici et exportables vers Flutter (<code class="font-mono text-xs bg-surface-100 px-1.5 py-0.5 rounded">ThemeExtension</code>) et JSON. Un <strong>Design System Manager interactif</strong> standalone permet de modifier les tokens visuellement et d'exporter le code Dart prÃªt Ã  l'emploi.
  </p>

  <!-- Link to standalone tool -->
  <div class="card p-6 mb-6 bg-gradient-to-br from-brand-50/60 to-white border-brand-200">
    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 rounded-xl bg-brand-600 flex items-center justify-center shadow-lg shadow-brand-500/20">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>
        </div>
        <div>
          <h3 class="font-bold text-surface-900">Design System Manager â€” Outil interactif</h3>
          <p class="text-xs text-surface-500 mt-0.5">Modifiez couleurs, typo, spacing visuellement â†’ export <code class="font-mono bg-surface-100 px-1 py-0.5 rounded text-[10px]">tokens.dart</code> + <code class="font-mono bg-surface-100 px-1 py-0.5 rounded text-[10px]">tokens.json</code></p>
        </div>
      </div>
      <a href="vision-crm-design-system.html" target="_blank" class="inline-flex items-center gap-2 px-5 py-2.5 bg-brand-600 text-white text-sm font-semibold rounded-xl hover:bg-brand-700 transition-colors shadow-md shadow-brand-500/20" style="text-decoration:none;">
        Ouvrir le Design System Manager â†’
      </a>
    </div>
  </div>

  <!-- Token reference tables -->
  <div class="grid lg:grid-cols-2 gap-6 mb-6">

    <!-- Colors -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-brand-100 flex items-center justify-center text-xs">ğŸ¨</span>
        Palette de couleurs
      </h3>

      <div class="mb-4">
        <p class="text-xs font-semibold text-surface-700 mb-2">Brand (primaire)</p>
        <div class="flex flex-wrap gap-1.5">
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#eef4ff;border:1px solid #e4e8f0;"></div><span class="font-mono text-[10px] text-surface-500">50</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#d9e6ff;"></div><span class="font-mono text-[10px] text-surface-500">100</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#bcd4ff;"></div><span class="font-mono text-[10px] text-surface-500">200</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#8eb8ff;"></div><span class="font-mono text-[10px] text-surface-500">300</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#5891ff;"></div><span class="font-mono text-[10px] text-surface-500">400</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#3269ff;"></div><span class="font-mono text-[10px] text-surface-500">500</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#1a46f5;"></div><span class="font-mono text-[10px] text-surface-500">600</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#1334e1;"></div><span class="font-mono text-[10px] text-surface-500">700</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#162cb6;"></div><span class="font-mono text-[10px] text-surface-500">800</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#182a8f;"></div><span class="font-mono text-[10px] text-surface-500">900</span></div>
        </div>
      </div>

      <div class="mb-4">
        <p class="text-xs font-semibold text-surface-700 mb-2">Surface (backgrounds, textes)</p>
        <div class="flex flex-wrap gap-1.5">
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#ffffff;border:1px solid #e4e8f0;"></div><span class="font-mono text-[10px] text-surface-500">0</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#f8f9fc;border:1px solid #e4e8f0;"></div><span class="font-mono text-[10px] text-surface-500">50</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#f1f3f8;"></div><span class="font-mono text-[10px] text-surface-500">100</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#e4e8f0;"></div><span class="font-mono text-[10px] text-surface-500">200</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#9ba5bd;"></div><span class="font-mono text-[10px] text-surface-500">400</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#6b7894;"></div><span class="font-mono text-[10px] text-surface-500">500</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#374151;"></div><span class="font-mono text-[10px] text-surface-500">700</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#1f2937;"></div><span class="font-mono text-[10px] text-surface-500">800</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#111827;"></div><span class="font-mono text-[10px] text-surface-500">900</span></div>
        </div>
      </div>

      <div>
        <p class="text-xs font-semibold text-surface-700 mb-2">Accents (statuts, actions)</p>
        <div class="flex flex-wrap gap-2">
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#10b981;"></div><span class="font-mono text-[10px] text-surface-500">emerald</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#f59e0b;"></div><span class="font-mono text-[10px] text-surface-500">amber</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#f43f5e;"></div><span class="font-mono text-[10px] text-surface-500">rose</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#8b5cf6;"></div><span class="font-mono text-[10px] text-surface-500">violet</span></div>
          <div class="flex items-center gap-1.5"><div class="w-6 h-6 rounded" style="background:#06b6d4;"></div><span class="font-mono text-[10px] text-surface-500">cyan</span></div>
        </div>
      </div>
    </div>

    <!-- Typography -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-violet-100 flex items-center justify-center text-xs">Aa</span>
        Typographie
      </h3>

      <div class="space-y-4 text-xs">
        <div>
          <p class="font-semibold text-surface-700 mb-2">Font Families</p>
          <div class="overflow-hidden rounded-lg border border-surface-200">
            <table class="w-full">
              <tbody>
                <tr class="border-b border-surface-100"><td class="px-3 py-2.5 font-semibold text-surface-800 w-20">Display</td><td class="px-3 py-2.5"><span class="font-display italic text-lg">Instrument Serif</span></td><td class="px-3 py-2.5 font-mono text-surface-400 text-[10px]">Titres, H1â€“H2</td></tr>
                <tr class="border-b border-surface-100"><td class="px-3 py-2.5 font-semibold text-surface-800">Body</td><td class="px-3 py-2.5"><span style="font-family:'DM Sans';">DM Sans</span></td><td class="px-3 py-2.5 font-mono text-surface-400 text-[10px]">Corps, labels, UI</td></tr>
                <tr><td class="px-3 py-2.5 font-semibold text-surface-800">Mono</td><td class="px-3 py-2.5"><span class="font-mono">JetBrains Mono</span></td><td class="px-3 py-2.5 font-mono text-surface-400 text-[10px]">Code, IDs, tokens</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div>
          <p class="font-semibold text-surface-700 mb-2">Ã‰chelle typographique</p>
          <div class="overflow-hidden rounded-lg border border-surface-200">
            <table class="w-full">
              <thead><tr><th class="px-3 py-2 bg-surface-100 text-left text-[10px] font-semibold uppercase tracking-wider text-surface-500">Token</th><th class="px-3 py-2 bg-surface-100 text-left text-[10px] font-semibold uppercase tracking-wider text-surface-500">Taille</th><th class="px-3 py-2 bg-surface-100 text-left text-[10px] font-semibold uppercase tracking-wider text-surface-500">Usage</th></tr></thead>
              <tbody>
                <tr class="border-b border-surface-100"><td class="px-3 py-2 font-mono text-surface-700">text-xs</td><td class="px-3 py-2 text-surface-600">11 px</td><td class="px-3 py-2 text-surface-400">Badges, micro-labels</td></tr>
                <tr class="border-b border-surface-100"><td class="px-3 py-2 font-mono text-surface-700">text-sm</td><td class="px-3 py-2 text-surface-600">13 px</td><td class="px-3 py-2 text-surface-400">Sidebar, tableaux, descriptions</td></tr>
                <tr class="border-b border-surface-100"><td class="px-3 py-2 font-mono text-surface-700">text-base</td><td class="px-3 py-2 text-surface-600">15 px</td><td class="px-3 py-2 text-surface-400">Corps de texte par dÃ©faut</td></tr>
                <tr class="border-b border-surface-100"><td class="px-3 py-2 font-mono text-surface-700">text-lg</td><td class="px-3 py-2 text-surface-600">18 px</td><td class="px-3 py-2 text-surface-400">Sous-titres, H4</td></tr>
                <tr class="border-b border-surface-100"><td class="px-3 py-2 font-mono text-surface-700">text-xl</td><td class="px-3 py-2 text-surface-600">20 px</td><td class="px-3 py-2 text-surface-400">H3</td></tr>
                <tr class="border-b border-surface-100"><td class="px-3 py-2 font-mono text-surface-700">text-2xl</td><td class="px-3 py-2 text-surface-600">24 px</td><td class="px-3 py-2 text-surface-400">H2</td></tr>
                <tr><td class="px-3 py-2 font-mono text-surface-700">text-3xl</td><td class="px-3 py-2 text-surface-600">30 px</td><td class="px-3 py-2 text-surface-400">H1, titres de section</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Spacing & Radius + Components reference -->
  <div class="grid lg:grid-cols-2 gap-6 mb-6">

    <!-- Spacing -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-amber-100 flex items-center justify-center text-xs">ğŸ“</span>
        Spacing & Border Radius
      </h3>

      <div class="mb-4">
        <p class="text-xs font-semibold text-surface-700 mb-2">Spacing Scale</p>
        <div class="space-y-2">
          <div class="flex items-center gap-3"><span class="font-mono text-[10px] text-surface-500 w-8">xs</span><div class="h-4 rounded bg-brand-100" style="width:4px;"></div><span class="font-mono text-[10px] text-surface-400">4 px</span></div>
          <div class="flex items-center gap-3"><span class="font-mono text-[10px] text-surface-500 w-8">sm</span><div class="h-4 rounded bg-brand-100" style="width:8px;"></div><span class="font-mono text-[10px] text-surface-400">8 px</span></div>
          <div class="flex items-center gap-3"><span class="font-mono text-[10px] text-surface-500 w-8">md</span><div class="h-4 rounded bg-brand-200" style="width:16px;"></div><span class="font-mono text-[10px] text-surface-400">16 px</span></div>
          <div class="flex items-center gap-3"><span class="font-mono text-[10px] text-surface-500 w-8">lg</span><div class="h-4 rounded bg-brand-200" style="width:24px;"></div><span class="font-mono text-[10px] text-surface-400">24 px</span></div>
          <div class="flex items-center gap-3"><span class="font-mono text-[10px] text-surface-500 w-8">xl</span><div class="h-4 rounded bg-brand-300" style="width:32px;"></div><span class="font-mono text-[10px] text-surface-400">32 px</span></div>
          <div class="flex items-center gap-3"><span class="font-mono text-[10px] text-surface-500 w-8">2xl</span><div class="h-4 rounded bg-brand-300" style="width:48px;"></div><span class="font-mono text-[10px] text-surface-400">48 px</span></div>
        </div>
      </div>

      <div>
        <p class="text-xs font-semibold text-surface-700 mb-2">Border Radius</p>
        <div class="flex flex-wrap gap-3">
          <div class="text-center"><div class="w-10 h-10 border-2 border-brand-400 bg-brand-50 mx-auto mb-1" style="border-radius:4px;"></div><span class="font-mono text-[10px] text-surface-400">sm 4px</span></div>
          <div class="text-center"><div class="w-10 h-10 border-2 border-brand-400 bg-brand-50 mx-auto mb-1" style="border-radius:8px;"></div><span class="font-mono text-[10px] text-surface-400">md 8px</span></div>
          <div class="text-center"><div class="w-10 h-10 border-2 border-brand-400 bg-brand-50 mx-auto mb-1" style="border-radius:12px;"></div><span class="font-mono text-[10px] text-surface-400">lg 12px</span></div>
          <div class="text-center"><div class="w-10 h-10 border-2 border-brand-400 bg-brand-50 mx-auto mb-1" style="border-radius:16px;"></div><span class="font-mono text-[10px] text-surface-400">xl 16px</span></div>
          <div class="text-center"><div class="w-10 h-10 border-2 border-brand-400 bg-brand-50 mx-auto mb-1" style="border-radius:24px;"></div><span class="font-mono text-[10px] text-surface-400">2xl 24px</span></div>
          <div class="text-center"><div class="w-10 h-10 border-2 border-brand-400 bg-brand-50 mx-auto mb-1" style="border-radius:9999px;"></div><span class="font-mono text-[10px] text-surface-400">full âˆ</span></div>
        </div>
      </div>
    </div>

    <!-- Components catalog -->
    <div class="card p-6">
      <h3 class="text-sm font-bold text-surface-900 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 rounded bg-emerald-100 flex items-center justify-center text-xs">ğŸ§±</span>
        Composants de base
      </h3>

      <div class="space-y-4 text-xs">
        <div>
          <p class="font-semibold text-surface-700 mb-2">Buttons</p>
          <div class="flex flex-wrap gap-2">
            <button class="px-4 py-2 bg-brand-600 text-white text-xs font-semibold rounded-xl">Primary</button>
            <button class="px-4 py-2 bg-surface-200 text-surface-700 text-xs font-semibold rounded-xl">Secondary</button>
            <button class="px-4 py-2 bg-accent-rose text-white text-xs font-semibold rounded-xl">Danger</button>
            <button class="px-4 py-2 border border-surface-200 text-surface-600 text-xs font-semibold rounded-xl bg-white">Outline</button>
          </div>
        </div>

        <div>
          <p class="font-semibold text-surface-700 mb-2">Badges</p>
          <div class="flex flex-wrap gap-1.5">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-semibold bg-brand-50 text-brand-700">MVP</span>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-semibold" style="background:rgba(16,185,129,.1);color:#10b981;">Actif</span>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-semibold" style="background:rgba(245,158,11,.1);color:#f59e0b;">En attente</span>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-semibold" style="background:rgba(244,63,94,.1);color:#f43f5e;">Erreur</span>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-semibold" style="background:rgba(139,92,246,.1);color:#8b5cf6;">IA</span>
          </div>
        </div>

        <div>
          <p class="font-semibold text-surface-700 mb-2">Inputs</p>
          <div class="space-y-1.5">
            <div class="px-3 py-2 border border-surface-200 rounded-lg text-surface-400 bg-white text-xs">identifiant mÃ©tierâ€¦</div>
            <div class="px-3 py-2 border-2 border-brand-500 rounded-lg text-surface-900 bg-white text-xs" style="box-shadow:0 0 0 3px rgba(50,105,255,.1);">AA-123-BB</div>
            <div class="px-3 py-2 border border-accent-rose rounded-lg text-accent-rose bg-white text-xs" style="box-shadow:0 0 0 3px rgba(244,63,94,.1);">Format invalide</div>
          </div>
        </div>

        <div>
          <p class="font-semibold text-surface-700 mb-2">Cards</p>
          <div class="flex gap-2">
            <div class="flex-1 p-3 bg-white border border-surface-200 rounded-xl"><span class="text-surface-600">Default</span></div>
            <div class="flex-1 p-3 bg-white border-2 border-brand-500 rounded-xl" style="box-shadow:0 0 0 3px rgba(50,105,255,.1);"><span class="text-brand-700">Selected</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Flutter integration guide -->
  <div class="card p-6 bg-surface-50 border-dashed">
    <h3 class="text-sm font-bold text-surface-900 mb-3 flex items-center gap-2">
      <span class="w-6 h-6 rounded bg-blue-100 flex items-center justify-center text-xs">ğŸ¯</span>
      IntÃ©gration Flutter â€” Guide rapide
    </h3>
    <div class="grid md:grid-cols-2 gap-6 text-xs text-surface-600">
      <div>
        <p class="font-semibold text-surface-800 mb-2">Workflow</p>
        <div class="space-y-2">
          <p class="flex items-start gap-2"><span class="w-5 h-5 rounded-full bg-brand-600 text-white text-[10px] font-bold flex items-center justify-center flex-shrink-0 mt-0.5">1</span>Ouvrir le <strong>Design System Manager</strong> (lien ci-dessus).</p>
          <p class="flex items-start gap-2"><span class="w-5 h-5 rounded-full bg-brand-600 text-white text-[10px] font-bold flex items-center justify-center flex-shrink-0 mt-0.5">2</span>Modifier les tokens visuellement (couleurs, typo, spacing).</p>
          <p class="flex items-start gap-2"><span class="w-5 h-5 rounded-full bg-brand-600 text-white text-[10px] font-bold flex items-center justify-center flex-shrink-0 mt-0.5">3</span>Cliquer <strong>Export tokens.dart</strong> â†’ fichier tÃ©lÃ©chargÃ©.</p>
          <p class="flex items-start gap-2"><span class="w-5 h-5 rounded-full bg-brand-600 text-white text-[10px] font-bold flex items-center justify-center flex-shrink-0 mt-0.5">4</span>Placer dans <code class="font-mono bg-white px-1.5 py-0.5 rounded border border-surface-200">lib/core/design_tokens.dart</code></p>
          <p class="flex items-start gap-2"><span class="w-5 h-5 rounded-full bg-accent-emerald text-white text-[10px] font-bold flex items-center justify-center flex-shrink-0 mt-0.5">5</span>Importer dans le <code class="font-mono bg-white px-1.5 py-0.5 rounded border border-surface-200">ThemeData</code> â†’ tokens accessibles partout.</p>
        </div>
      </div>
      <div>
        <p class="font-semibold text-surface-800 mb-2">Usage dans un widget</p>
        <div class="bg-surface-900 text-surface-200 rounded-lg p-4 font-mono text-[11px] leading-relaxed overflow-x-auto">
          <span style="color:#93c5fd;">final</span> tokens = Theme.of(context)<br>
          &nbsp;&nbsp;.extension&lt;<span style="color:#c4b5fd;">VisionTokens</span>&gt;()!;<br><br>
          <span style="color:#93c5fd;">Container</span>(<br>
          &nbsp;&nbsp;color: tokens.<span style="color:#86efac;">brandPrimary</span>,<br>
          &nbsp;&nbsp;padding: <span style="color:#93c5fd;">EdgeInsets</span>.all(<br>
          &nbsp;&nbsp;&nbsp;&nbsp;tokens.<span style="color:#86efac;">spaceMd</span>,<br>
          &nbsp;&nbsp;),<br>
          &nbsp;&nbsp;child: <span style="color:#93c5fd;">Text</span>(<span style="color:#fbbf24;">'Hello'</span>,<br>
          &nbsp;&nbsp;&nbsp;&nbsp;style: <span style="color:#93c5fd;">TextStyle</span>(<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fontFamily: tokens.<span style="color:#86efac;">fontBody</span>,<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fontSize: tokens.<span style="color:#86efac;">textBase</span>,<br>
          &nbsp;&nbsp;&nbsp;&nbsp;),<br>
          &nbsp;&nbsp;),<br>
          )
        </div>
        <p class="text-[10px] text-surface-400 mt-2">Les tokens sont typÃ©s â€” autocomplÃ©tion et erreurs de compilation si token manquant.</p>
      </div>
    </div>
  </div>
</section>

<!-- Footer -->
  <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
    <div class="flex items-center gap-2.5">
      <div class="w-6 h-6 rounded-lg bg-gradient-to-br from-brand-500 to-brand-700 flex items-center justify-center">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>
      </div>
      <span class="text-sm font-semibold text-surface-800">Vision CRM â€” PRD Final v1.0</span>
    </div>
    <p class="text-xs text-surface-400">VisionProdâ€‘Labz Â· FÃ©vrier 2026 Â· 19 sections Â· Document confidentiel</p>
  </div>
</footer>

</main>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  const sections = document.querySelectorAll('section[id]');
  const navLinks = document.querySelectorAll('.sidebar-link');
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        navLinks